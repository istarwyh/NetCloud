define("clouddisk-ui:widget/context-menu/context-menu.js",function(e){var i=e("common:widget/libs/jquerypacket.js"),t=e("common:widget/commonService/commonService.js"),n=e("common:widget/data-center/data-center.js"),o={mod:"div.module-context-menu",main:"ul[node-type~='menu-main']",device:"a[node-type~='device']",list:"div[node-type~='list']",listNode:"li[node-type~='list-node']",menuDevice:"ul[node-type~='menu-device']",btnOperate:'a[node-type~="item"]',open:'a[node-type~= "open"]',download:'a[node-type~= "download"]',addDevice:'a[node-type~= "device-add"]'},d=i(o.mod),a={},c=function(){var i=e("common:widget/api-center/api-center.js");d.find(o.menuDevice).html('<li class="global-center"><span>正在加载设备...</span></li>'),i.getDeviceListAsyc({},function(e){for(var i=[],t=e.device_list,n=0,a=0;a<t.length;a++){var c=t[a].is_online?"device-online":"device-outline";0!=t[a].has_access_token&&0!=t[a].status&&t[a].is_online&&"1"==t[a].device_capacity[0]&&(n++,i.push('<li><a class="device-type" deviceType="'+t[a].device_id+"|"+c+'" href="javascript:;"><em class="'+c+'"></em>'+t[a].device_desc+"</a></li>"))}0==n&&(i.push('<li><a class="device-disabled" href="javascript:;">无在线设备</a></li>'),i.push('<li><a class="device-add" node-type="device-add" href="javascript:;">添加设备</a></li>')),d.find(o.menuDevice).html(i.join(""))})},s={init:function(){var e=this;e.device=!1,e.$mod=d,e.$main=d.find(o.main),e.$device=d.find(o.device),e.$menuDevice=d.find(o.menuDevice),e.$listNode=d.find(o.listNode),e.bindEvent(),e.bindListen()},bindListen:function(){var e=this;mdev.message.listen("context-menu-render",function(i,t){{var i=e.getEvent(i);e.getTarget(i)}e.buttonRender(t),e.menuShow(i)}),mdev.message.listen("context-menu-hide",function(){e.menuHide()})},buttonRender:function(e){var i,t,n,d=this.$mod.find(o.btnOperate);for(t=0;t<d.length;t++)i=d.eq(t),n=i.data("key"),i=i.parent(),i.hide(),"enable"===e[n]&&i.show().children().removeClass("disabled"),"disable"===e[n]&&(i.show().children().addClass("disabled"),"print"===n|"prettify"===n|"open"===n&&i.hide())},bindEvent:function(){var e=this,c=!1;d.bind("contextmenu",function(){return!1}),d.mouseleave(function(){setTimeout(function(){c||e.device||e.$main.hide()},500),c=!1}),d.mouseenter(function(){c=!0}),e.$device.mouseenter(function(){var i=e.getEvent(i);e.showDevice(i),e.device=!1}),e.$device.mouseleave(function(i){{var i=e.getEvent(i);e.getTarget(i)}setTimeout(function(){e.device||(e.$menuDevice.hide(),e.device=!1)},100)}),e.$menuDevice.mouseenter(function(){e.device=!0}),e.$menuDevice.mouseleave(function(){e.$menuDevice.hide()}),e.$main.delegate(".list-node","click",function(t){var n=i(t.target).closest(".list-node").data("key");"push"!==n&&(mdev.message.trigger("file-operate",n),e.menuHide())}),d.delegate(o.addDevice,"click",function(){t.getWidgets("common:widget/deviceAddEquipment/deviceAddEquipment.js",function(e){a.deviceAddEquipment=a.deviceAddEquipment||new e,a.deviceAddEquipment.show()})}),d.delegate(o.menuDevice,"click",function(e){var i=e.target;switch(d.hide(),targetNode="EM"==i.tagName?i.parentNode:i,targetNode.className){case"device-type":var t=targetNode.getAttribute("deviceType").split("|"),o=t[0],a=t[1];a&&"device-outline"==a?Toast.obtain.useToast({toastMode:Toast.obtain.MODE_CAUTION,msg:"设备处于离线状态，不可推送，请检查设备",sticky:!1}):(n.set("current-push-device",o),mdev.message.trigger("file-operate","push-file"))}}),d.delegate(o.menuDevice,"mouseleave",function(){e.$main.hide()})},menuShow:function(e){var t=this,n=e.clientX,o=e.clientY,a=t.$main.height(),c=t.$main.width(),s=i(window).height(),u=i(window).width();a>s-o?o=o-a+5:o-=5,c>u-n?n=n-c+5:n-=5,t.menuX=n,t.menuY=o,t.$main.css({display:"block",left:n,top:o}),d.show()},menuHide:function(){this.$main.hide()},showDevice:function(){var e=this,t=d.find(o.open),n=d.find(o.download),a=e.menuX+e.$main.outerWidth(),s=e.menuY+n.height()+parseInt(n.css("margin-top"),10)+parseInt(n.css("margin-bottom"),10)+parseInt(d.find(o.main).css("padding-top"),10)+1;"list-item"===t.parent().css("display")&&(s=s+t.height()+parseInt(t.css("margin-top"),10)),i(window).width()-e.menuX<2*e.$main.outerWidth()&&(a=e.menuX-e.$menuDevice.outerWidth()),"Microsoft Internet Explorer"==window.navigator.appName&&"7."==window.navigator.appVersion.match(/7./i)&&(s+=20),window.XMLHttpRequest||(s+=20),e.$menuDevice.css({display:"block",top:s,left:a}),c()},stopPropagation:function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},getEvent:function(e){return e?e:window.event},getTarget:function(e){return e.target||e.srcElement},contains:function(e,i){if(/AppleWebKit\/(\S+)/.test(navigator),webkit=RegExp.$1,webkit=parseFloat(webkit),"function"==typeof e.contains&&(!webkit||webkit>=522))return e.contains(i);if("function"==typeof e.compareDocumentPosition)return!!(16&e.compareDocumentPosition(i));var t=i.parentNode;do{if(t===e)return!0;t=t.parentNode}while(null!=t);return!1}};s.init()});
;define("clouddisk-ui:widget/crumbs/crumbs.js",function(e){var t={mod:"div.module-crumbs",tmplCrumbs:'textarea[node-type~="tmpl-crumbs"]',crumbList:'span[node-type~="crumbs"]',crumbItem:'a[node-type~="crumbs-item"]',loadNum:'span[node-type~="load-num"]'},m=e("common:widget/libs/jquerypacket.js"),n=(e("common:widget/commonService/commonService.js"),m(t.mod)),a=function(){n.delegate(t.crumbItem,"click",function(t){var n=e("common:widget/hash/hash.js"),a=m(t.target);n.set("path",a.data("path"))})},r=function(m){var a=e("common:widget/data-center/data-center.js"),r=(a.set("currentDir",m),n.find(t.tmplCrumbs).val()),c=n.find(t.crumbList),s={mToolBar:{crumbs:[]}},i=[];"/"===m.trim()?i.push(""):(i=m.trim().split("/"),""===i[i.length-1]&&i.pop());var o=[];i.length>1&&o.push({key:0,path:i.length>2?i.slice(0,i.length-1).join("/"):"/"});for(var l,u=0;u<i.length;u++){var d=i[u];l={},1===i.length?l={key:2,name:"全部文件"}:i.length<5?l=0===u?{key:1,name:"全部文件"}:u===i.length-1?{key:2,name:d}:{key:1,name:d}:0===u?l={key:1,name:"全部文件"}:u===i.length-1?l={key:2,name:d}:u===i.length-4?l={key:3,name:d}:u>i.length-4&&(l={key:1,name:d}),l.path=i.slice(0,u+1).join("/"),""===l.path&&(l.path="/"),l.path&&o.push(l)}m.match(/^search-/)&&(o=[{key:0,path:"/"},{key:1,name:"全部文件",path:"/"},{key:2,name:'搜索："'+m.split("search-")[1]+'"'}]),s.mToolBar.crumbs=o,c.html(mdev.tmpl(r,s))},c=function(){a(),mdev.message.listen("render-crumbs",function(e){r(e)}),mdev.message.listen("render-crumbs-count",function(e,m){var a="";a=m?"已全部加载，共"+e+"个":"已加载"+e+"个",-1===e&&(a="获取更多数据..."),n.find(t.loadNum).html(a)});var m=n.find(t.crumbList),c=e("common:widget/data-center/data-center.js"),s=c.get("page");"recyclebin"===s&&m.html("回收站"),"share-manage"===s&&m.html("全部文件")};c()});
;define("clouddisk-ui:widget/list-view/disk-home.js",function(e,t,i){var s=e("common:widget/commonService/commonService.js"),a=e("common:widget/fileDelete/fileDelete.js"),n=e("common:widget/fileManagerApi/fileManagerApi.js"),o=e("common:widget/restApi/restApi.js"),r=e("common:widget/hash/hash.js"),l=e("common:widget/toast/toast.js"),c=(e("common:widget/context/context.js"),e("common:widget/libs/jquerypacket.js")),d=e("common:widget/data-center/data-center.js"),g={},m=536e3,u=function(e){if(p.list.cash){for(var t,i=0;i<p.list.cash.length&&(t=p.list.cash[i],t.fs_id.toString()!==e.toString());i++);return t}},f=function(e){var t=0;for(getItem=[],t;t<e.length;t++)getItem.push(u(e[t]));return getItem},p={};p.list={cash:{},params:{num:100,page:1,dir:"/",order:"time",desc:1,showempty:0},cxt:{},renderCallback:null,lastPage:-1,isMore:!0,isBusy:!1},d.get("isIE6")&&(p.list.params.num=30),p.list.cxt={mListView:{width:{name:"60%",cols:["16%","23%"]},title:{name:"文件名",cols:["大小","修改日期"]},titleKey:{name:"name",cols:["size","time"]},isAppend:!1,list:[]}},p.list.cxtSearch={mListView:{width:{name:"60%",cols:["16%","13%","10%"]},title:{name:"文件名",cols:["大小","修改日期","所在目录"]},titleKey:{name:"name",cols:["size","time","path-info"]},isAppend:!1,list:[]}},p.list.formatListData=function(e){var t,i,a,n=[],o={};for(o.list=e,t=0;t<o.list.length;t++){i=o.list[t],a={},a.id=i.fs_id,a.name=i.server_filename,a.category=i.category,a.cols=[s.toFriendlyFileSize(i.size),s.parseDate(i.server_mtime)],i.isdir&&(a.cols[0]="-"),i.path.match(/^\/apps$/)&&(a.name="我的应用数据"),i.thumbs&&i.thumbs.url1&&(a.thumb=i.thumbs.url1);var r,l,c=i.path.split("/");2===c.length?(r="/",l="全部文件"):(r=c.slice(0,c.length-1).join("/"),l=c[c.length-2]),p.list.params.key&&a.cols.push('<span class="search-feild" node-type="search-feild" data-path="'+r+'" title="'+l+'">'+l+"</span>"),a.extName=s.getFileExtName(i.path,i.isdir),a.btns=["share","download","more"],a.openEnabled=s.isOpenedFile(a.extName),n.push(a)}return n},p.list.formatCategoryData=function(e){var t,i,a,n=[],o={};for(o.info=e,t=0;t<o.info.length;t++)i=o.info[t],a={},a.id=i.fs_id,a.name=i.server_filename,a.category=i.category,a.cols=[s.toFriendlyFileSize(i.size),s.parseDate(i.server_mtime)],i.isdir&&(a.cols[0]="-"),i.thumbs&&i.thumbs.url1&&(a.thumb=i.thumbs.url1),a.extName=s.getFileExtName(i.path,i.isdir),a.btns=["share","download","more"],a.openEnabled=s.isOpenedFile(a.extName),n.push(a);return n},p.list.lastRenderType=r.get("render-type"),p.list.lastKey=r.get("key"),p.list.lastPath=r.get("path"),p.list.lastCategory=r.get("category/type"),p.list.lastRenderType&&""!==p.list.lastRenderType||(p.list.lastRenderType="list-view"),p.listenHash=function(){var e;r.listen("key, path, category/type, render-type",function(){window.clearTimeout(e),e=window.setTimeout(function(){var e=r.get("render-type"),t=r.get("key"),i=r.get("path"),s=r.get("category/type");s===p.list.lastCategory&&t===p.list.lastKey&&i===p.list.lastPath&&e!==p.list.lastRenderType?d.set("isOnlyRenderTypeChange",!0):d.set("isOnlyRenderTypeChange",!1),p.list.params.page=1,y.render(p.list.renderCallback),p.list.lastRenderType=e,p.list.lastKey=t,p.list.lastPath=i,p.list.lastCategory=s},100)})};var h=!1,y={orderKey:"time",isDesc:!0,loading:function(){},setListRenderHandler:function(e){"function"==typeof e&&(p.list.renderCallback=function(){e.apply(void 0,arguments),h||(mdev.message.trigger("after-list-loaded"),h=!0)})},setListLoadingHandler:function(){},sort:function(e,t){p.list.params.order=e,t?p.list.params.desc=1:delete p.list.params.desc,p.list.params.page=1,p.list.isSorting=!0,this.render(p.list.renderCallback)},renderTitle:function(e){var t=p.list.cxt;p.list.params.key&&(t=p.list.cxtSearch),p.list.renderTitleCallback=p.list.renderTitleCallback||e,p.list.renderTitleCallback&&p.list.renderTitleCallback(t)},render:function(t){var i=this,s=p.list.cxt,a=p.list.params,n=r.get("category/type"),o=r.get("path"),l=r.get("key");a.category=n,a.dir=o,a.key=l,a.dir&&""!==a.dir?(delete a.category,delete a.key):a.key?(delete a.category,a.dir="",s=p.list.cxtSearch):a.category&&""!==a.category?(delete a.key,a.dir="/","time2"===a.order&&(a.order="time"),"2"===a.category?(a.category="3",d.get("is-timeline")&&r.set("render-type","grid-view"),"time"===a.order,"function"==typeof t&&(p.list.renderCallback=t)):"3"===a.category&&(a.category="2")):(delete a.category,delete a.key,a.dir="/"),y.renderTitle(),this.orderKey=a.order,this.isDesc=a.desc,"time2"===this.orderKey&&(this.orderKey="time"),d.set("orderKey",a.order),d.set("isDesc",a.desc);var c=!1;1!==a.page?c=!0:(p.list.isMore=!0,p.list.isSorting?p.list.isSorting=!1:this.loading(!0)),mdev.message.trigger("render-crumbs-count",-1);var g=e("common:widget/api-center/api-center.js");a.category?(a.desc||(a.desc=0),g.getFileListByCategoryAsyc(a,function(e){return!e.info.length&&a.page>1?(mdev.message.trigger("render-crumbs-count",p.list.cash.length,!0),p.list.isMore=!1,void 0):(e.info.length<a.num&&(p.list.isMore=!1),p.list.cash=c?p.list.cash.concat(e.info):e.info,s.mListView.list=p.list.formatCategoryData(e.info),p.list.renderCallback(s,c),mdev.message.trigger("render-crumbs",a.dir),mdev.message.trigger("render-crumbs-count",p.list.cash.length,e.info.length<a.num),i.loading(!1),void 0)})):a.key?g.searchFileListAsyc(a,function(e){return!e.list.length&&a.page>1?(p.list.isMore=!1,mdev.message.trigger("render-crumbs-count",p.list.cash.length,!0),void 0):(e.list.length<a.num&&(p.list.isMore=!1),p.list.cash=c?p.list.cash.concat(e.list):e.list,s.mListView.list=p.list.formatListData(e.list),p.list.renderCallback(s,c),mdev.message.trigger("render-crumbs","search-"+a.key),mdev.message.trigger("render-crumbs-count",p.list.cash.length,e.list.length<a.num),i.loading(!1),void 0)}):g.getFileListAsyc(a,function(e){return!e.list.length&&a.page>1?(p.list.isMore=!1,mdev.message.trigger("render-crumbs-count",p.list.cash.length,!0),void 0):(e.list.length<a.num&&(p.list.isMore=!1),p.list.cash=c?p.list.cash.concat(e.list):e.list,s.mListView.list=p.list.formatListData(e.list),p.list.renderCallback(s,c),mdev.message.trigger("render-crumbs",a.dir),mdev.message.trigger("render-crumbs-count",p.list.cash.length,e.list.length<a.num),i.loading(!1),void 0)})},loadMore:function(){p.list.isMore&&(p.list.params.page++,this.render(p.list.renderCallback))},share:function(e){var t=f(e);s.getWidgets("common:widget/shareDialog/shareDialog.js",function(){mdev.message.trigger("share",{list:t})})},download:function(e){var t=f(e);s.getWidgets("common:widget/downloadProxyPcs/downloadProxyPcs.js",function(){mdev.message.trigger("download",{list:t})})},move:function(e,t){var i=f(e);s.getWidgets("common:widget/fileMoveCopyManager/fileMoveCopyManager.js",function(e){g.fileMoveCopyManager=g.fileMoveCopyManager||new e,g.fileMoveCopyManager.reBuild({list:i,filemanager:"move",succCallback:function(){t()},failCallback:function(){}})})},copy:function(e){var t=f(e);s.getWidgets("common:widget/fileMoveCopyManager/fileMoveCopyManager.js",function(e){g.fileMoveCopyManager=g.fileMoveCopyManager||new e,g.fileMoveCopyManager.reBuild({list:t,filemanager:"copy",succCallback:function(){},failCallback:function(){}})})},rename:function(e,t,i){var a=u(e);s.getWidgets("common:widget/fileReName/fileReName.js",function(e){g.fileReName=g.fileReName||e.obtain,g.fileReName.sendUpdateFileMessage(a.isdir,a.path,t,function(){var e=a.path.split("/");e[e.length-1]=t,a.path=e.join("/"),a.server_filename=t,i()})})},print:function(e){var t=f(e);s.getWidgets("common:widget/fileCloudPrint/fileCloudPrint.js",function(e){e.obtain.reBuild({list:t})})},history:function(e){var t=f(e);s.getWidgets("common:widget/fileVersionHistory/fileVersionHistory.js",function(e){g.fileVersionHistory=new e,g.fileVersionHistory.reBuild({desc:1,list:t,isVip:!0})})},del:function(e,t){var i=f(e);a.obtain.done({fileList:i,succCallback:t})},imagePre:function(e){var t=f(e),i=[],a=[];s.getWidgets("common:widget/picPreview/picPreview.js",function(){var e,s=0,n=0,o=0;for(e=p.list.cash.length;e>s;s++){var r=p.list.cash[s];"3"==r.category&&(i.push(r),r==t[0]?o=n:n++)}mdev.message.trigger("show_picture",{index:o,list:i}),mdev.message.listen("delete_picPreview",function(e){var t=a.length>0?a:i,s=0;for(a=[],s;s<t.length;s++)s!=e.index&&a.push(i[s]);e.callback(a),y.render(p.list.renderCallback)}),mdev.message.trigger("quota-change"),mdev.message.listen("load_more_pre",function(e){e.callback()}),mdev.message.listen("load_more_next",function(e){e.callback()})})},musicPlay:function(e){var t=u(e),i=[{songId:m++,songName:s.parseDirFromPath(t.path)}],a=function(e){i[0].link=e,s.getWidgets("common:widget/musicBox/musicBox.js",function(e){"undefined"==typeof g.musicBox?g.musicBox=new e(i):g.musicBox.reBuild(i)})};s.getDlink('["'+t.fs_id+'"]',"dlink",function(e){t.dlink=e.dlink[0].dlink,a(s.downloadURL(t))})},musicPlayAll:function(e){var t=f(e),i=[],a=function(e){s.getWidgets("common:widget/musicBox/musicBox.js",function(t){"undefined"==typeof g.musicBox?g.musicBox=new t(e):g.musicBox._mDisplay?(g.musicBox.clearList(),g.musicBox.resetList(e,!0)):(g.musicBox._reInit(),g.musicBox.clearList(),g.musicBox.setVisible(!0),g.musicBox.addMusicData(e,!0))})},n=function(e){for(var i="",n=0,o=t.length;o>n;n++)i+=n===o-1?'"'+t[n].fs_id+'"':'"'+t[n].fs_id+'",';i="["+i+"]",s.getDlink(i,"dlink",function(i){var n=i.dlink;if(n.length>=1)for(var o=0,r=n.length;r>o;o++)t[o].dlink=n[o].dlink,e[o].link=s.downloadURL(t[o]);else 0===n.length&&(e.dlink=s.downloadURL(n));a(e)})};if(0==t.length)return l.obtain.useToast({toastMode:l.obtain.MODE_CAUTION,msg:"当前列表为空，请添加音乐文件",sticky:!1}),!1;for(var o=0,r=t.length;r>o;o++)i.push({songId:m++,songName:s.parseDirFromPath(t[o].path),link:s.downloadURL(t[o])});n(i)},playVedio:function(t){var i=u(t),s=e("common:widget/filePlayVedio/filePlayVedio.js");g.filePlayVedio=g.filePlayVedio||s.obtain,g.filePlayVedio.reBuild(i)},otherFile:function(e){var t=u(e);return subffix=s.getFileExtName(t.server_filename),"dws"==subffix||"dwt"==subffix||"dxf"==subffix||"dwg"==subffix?(this.openCad(e),void 0):"zip"==subffix||"rar"==subffix?(this.unZip(e),void 0):void 0},openCad:function(e){var t=u(e);t.path&&window.open("http://pan.baidu.com/disk/cadedit?path="+encodeURIComponent(encodeURIComponent(t.path)))},unZip:function(e){var t=u(e);s.getWidgets("common:widget/fileUnzip/fileUnzip.js",function(e){g.fileUnzip=g.fileUnzip||e.obtain({vip:!0}),g.fileUnzip.startResolveUnZip(t.path,t.size,1===parseInt(yunData.ISVIP,10)?!0:!1)})},torrent:function(e){var t=f(e),i=t[0];s.getWidgets("common:widget/resolveBTDialog/resolveBTDialog.js",function(e){g.resolveBTDialog=g.resolveBTDialog||e.obtain(),"function"==typeof g.resolveBTDialog.setTaskFrom&&g.resolveBTDialog.setTaskFrom(e.TASK_FROM_HOMEPAGE),g.resolveBTDialog.resolveBTFile(i.path)})},docReader:function(e){var t=f(e),i=t[0];s.getWidgets("common:widget/docReader/docReader.js",function(e){g.docReader=g.docReader||new e,g.docReader.reBuild(i)})},meitu:function(t){var i=f(t),s=e("common:widget/fileMeitu/fileMeitu.js");g.fileMeitu=g.fileMeitu||new s,g.fileMeitu.build(i)},push:function(t){var i=f(t),s=e("common:widget/devicePushTask/devicePushTask.js");s.obtain.commandPublish({deviceId:d.get("current-push-device"),selectArray:i})},newDir:function(e,t){l.obtain.useToast({toastMode:l.obtain.MODE_LOADING,msg:"正在创建文件夹&hellip;",sticky:!0}),n.sendCreateNewFileApi(e,"",1,null,function(e){0==e.errno&&(p.list.cash.push(e),"function"==typeof t&&t(e),l.obtain.useToast({toastMode:l.obtain.MODE_SUCCESS,msg:"创建文件夹成功",sticky:!1}))},function(e){return l.obtain.useToast({toastMode:l.obtain.MODE_CAUTION,msg:e,sticky:!1}),!1})},nameClick:function(t){var i=u(t),s=e("common:widget/hash/hash.js");if(i.isdir)s.set("path",i.path);else switch(i.category){case 1:this.playVedio([t]);break;case 2:this.musicPlay([t]);break;case 3:this.imagePre([t]);break;case 4:this.docReader([t]);break;case 6:this.otherFile([t]);break;case 7:this.torrent([t])}},folderOpen:function(e){var t=u(e);r.set("path",s.parseFullDirFromPath(t.path)+"/")}},v={showPresentMember:function(){return!window.localStorage||localStorage&&localStorage.getItem("presentMember")?!1:(c.get(o.VIP_USER+"?method=query",function(e){var t=null;try{t=c.parseJSON(e)}catch(i){}if(t&&t.product_infos&&t.product_infos.length>0)for(var a=t.product_infos,n=a.length;n--;)"vip1_3m"===a[n].product_name&&s.getWidgets("common:widget/adTips/presentMembership/presentMembership.js",function(e){e.obtain.setVisible(!0),localStorage&&localStorage.setItem("presentMember",!0)})}),void 0)},showFeatureManual:function(){return!window.localStorage||localStorage&&localStorage.getItem(yunData.MYNAME+"_vip_wizard_display")||0==yunData.ISVIP?!1:(s.getWidgets("common:widget/adTips/featureManual/featureManual.js",function(e){e.obtain.show(),localStorage&&localStorage.setItem(yunData.MYNAME+"_vip_wizard_display",!0)}),void 0)},worldTips:function(){return!window.localStorage||localStorage&&localStorage.getItem("world2013_vip")?!1:(c.get("/disk/cmsdata?do=manual&ch=pan_act_tips",function(e){var e=c.parseJSON(e);if(e&&0==e.errorno&&e.content&&0==e.content[0].errno&&"world_2013_2T"==e.content[0].statue)c.get("/activity/query?type=all",function(t){var t=c.parseJSON(t);if(0==t.offlinedl||0==t.volume360)s.getWidgets("common:widget/adTips/worldTips/worldTips.js",function(e){e(),localStorage&&localStorage.setItem("world2013_vip",!0)});else if(!e||0!=e.errorno||!e.content||0!=e.content[2].errno||"homePage_c2c_guide"!=e.content[2].statue)return});else if(!e||0!=e.errorno||!e.content||0!=e.content[2].errno||"homePage_c2c_guide"!=e.content[2].statue)return}),void 0)}},w=function(){if(p.listenHash(),mdev.message.listen("file-list-render",function(e){e.time2&&(p.list.params.order="time2",p.list.params.desc=1),p.list.params.page=1,y.render(p.list.renderCallback)}),s.sendUserReport(s.compilePingBack()),"undefined"!=typeof window.localStorage)switch(parseInt(10*Math.random()/4)){case 0:v.showPresentMember();break;case 1:v.showFeatureManual();break;case 2:v.worldTips()}window.setTimeout(function(){y.render()},0),mdev.message.listen("after-list-loaded",function(){s.killFrame(),s.watchCDNOfPCS(),s.testPCSCDNConnectivity()})};w(),i.exports=y});
;define("clouddisk-ui:widget/grid-view/grid-view.js",function(e){var t=e("common:widget/libs/jquerypacket.js"),i=e("common:widget/hash/hash.js"),n=e("common:widget/data-center/data-center.js"),a=(e("common:widget/commonService/commonService.js"),e("common:widget/scrollUtils/scrollUtils.js")),l=e("common:widget/shortcut/keyboard.js"),o={mod:"div.module-grid-view",tmpl:'textarea[node-type~="tmpl"]',list:'div[node-type="list"]',item:'div[node-type="item"]',itemChk:'span[node-type="item-chk"]',chkAll:'span[node-type="chk-all"]',nameText:'a[node-type~="name"]',editName:'div[node-type~="edit-name"]',editNameBox:'input[node-type~="edit-name-box"]',editNameSure:'span[node-type~="edit-name-sure"]',editNameCancel:'span[node-type~="edit-name-cancel"]',loading:'div[node-type~="loading"]',newDir:'div[node-type~="new-dir"]',newDirBox:'input[node-type~="new-dir-box"]',newDirSure:'span[node-type~="new-dir-sure"]',newDirCancel:'span[node-type~="new-dir-cancel"]'},s={},d={},r=!1,c=t(o.mod),m=function(){c.find(o.newDir).prependTo(c.find(o.list)),c.find(o.newDir).show().find(o.newDirBox).val("新建文件夹").select(),c.find(o.list).scrollTop(0),"none"===c.css("display")&&c.show()},f=function(){c.find(o.newDir).appendTo(c),c.find(o.newDir).hide(),0===c.find(o.list).find(o.item).length&&c.hide()},h=function(){v.calSelected(function(){var e=n.get("selectedItemList");e.forEach(function(e){e.remove(),v.onDelete(e)}),v.calSelected()})},g=function(e,i){if(!r){var l=c.find(o.tmpl).val(),d=mdev.tmpl(l,e),m=c.find(o.list);if(i){var f=t(d);m.append(f),v.saveItems(f.filter(o.item),!0)}else m.html(d),m.scrollTop(0),e.mListView.list.length?(c.show(),mdev.message.trigger("render-list-empty",!1)):(c.hide(),v.saveItems([]),v.calSelected(),mdev.message.trigger("render-list-empty",!0)),v.saveItems(c.find(o.list).find(o.item));p();var h=n.get("selectedList");v.selectList(h),n.get("isOnlyRenderTypeChange")||v.calSelected();var g=c.find(o.item);t.each(g,function(e){var i=g.eq(e).find(".thumb-large"),n=i.data("thumb");if(n){try{n=n.replace(/size=.*&/,"size=c100_u84&")}catch(a){}{t("<img>").bind("load",function(){i.css("background",'url("'+n+'") center center no-repeat')}).attr("src",n)}}}),n.get("isIE6")&&(a.resolveHasScroll(c.find(o.list))||s.loadMore())}},p=function(){var e=c.find(o.list);if(e.length){var i=e.offset().top,n=t(window).height();e.height(n-i).css("overflow","auto")}},u=function(e){var t=e.closest(o.item),i=t.find(o.nameText),n=t.find(o.editName),a=t.find(o.editNameBox);i.hide(),n.show(),a.val(i.html()).select()},v=function(){var t=[],i=!1,a=function(e,t){var i=e.closest(o.item);t?(e.addClass("item-chked"),i.addClass("item-active")):(e.removeClass("item-chked"),i.removeClass("item-active"))},l=function(e){var n,l;for(n=0;n<t.length;n++)l=t[n].find(o.itemChk),e&&!l.hasClass("item-chked")&&a(l,!0),!e&&l.hasClass("item-chked")&&a(l,!1);i=e?!0:!1},r=function(){l(!0)},m=function(){l(!1)},f=e("common:widget/hash/hash.js"),h=n.get("page");d={};var g,p=function(i){window.clearTimeout(g),g=window.setTimeout(function(){var a,l,r,c=e("common:widget/commonService/commonService.js"),m=0,g=!0,p=!1,u=[],v=[];for(r=0;r<t.length;r++)a=t[r].find(o.itemChk),l=a.closest(o.item),"share-manage"===h&&l.find(o.copyBar).hide().attr("id",""),a.hasClass("item-chked")&&(m++,u.push(l.attr("data-id")),v.push(l),"share-manage"===h&&i===l.index()&&(l.find(o.copyBar).show().attr("id","copyBar"),s.copyShareUrl()),3!==l.data("category")&&(g=!1),c.isSpecialFile(l.data("extname"))&&(p=!0));n.set("selectedList",u),n.set("selectedItemList",v),"recyclebin"===h&&(d.restore="enable",d["delete-completely"]="enable"),"share-manage"===h&&(d.unshare="enable"),"disk-home"===h&&(d.share="enable",d.download="enable",d["delete"]="enable",d.push="enable",d.more="enable",d.move="enable",d.copy="enable",d.history="disable",d.rename="disable",d.print="disable",d.prettify="disable",d.puzzle="disable","3"===f.get("category/type")?d.music="enable":delete d.music),"disk-home"===h&&(1===m?(d.rename="enable",v[0].hasClass("enabled")?d.open="enable":delete d.open):delete d.open,1===m&&4===v[0].data("category")&&(d.history="enable"),1===m&&["dir","shouchang","yingyong","yingyong_child","beifen"].indexOf(v[0].data("extname"))<0&&(f.get("category/type")&&""!==f.get("category/type")||f.get("key")&&""!==f.get("key"))&&(!f.get("path")||""===f.get("path"))?d["folder-open"]="enable":delete d["folder-open"],g&&(d.print="enable"),1===m&&g&&(d.prettify="enable",d.puzzle="disable"),m>1&&g&&(d.puzzle="enable",d.prettify="disable"),p&&(d["delete"]="disable",d.rename="disable",d.move="disable")),mdev.message.trigger("list-toolbar-render",m,m===t.length,d),k.isMulti=m>=2?!0:!1,"function"==typeof i&&i()},0)},u=e("common:widget/shortcut/mouse-selection.js"),v=new u(c.find(o.list)),g=null,w=+[1]?0:50;v.onSelect=function(e){window.clearTimeout(g),g=window.setTimeout(function(){var i,n,l,s;for(i=0;i<t.length;i++)s=t[i].find(o.itemChk),n=t[i].offset(),l=t[i].outerHeight(),width=t[i].outerWidth(),(n.top<e.top&&n.top+l>e.top||n.top>e.top&&n.top+l<e.top+e.height||n.top<e.top+e.height&&n.top+l>e.top+e.height)&&(n.left<e.left&&n.left+width>e.left||n.left>e.left&&n.left+width<e.left+e.width||n.left<e.left+e.width&&n.left+width>e.left+e.width)?a(s,!0):a(s,!1);p()},w)};var k={isMulti:!1,select:a,selectAll:r,selectedList:[],selectedItemList:[],unSelectAll:m,calSelected:p,isChked:function(e){return e.hasClass("item-chked")},saveItems:function(e,n){n||(t=[]);var a;for(a=0;a<e.length;a++)t.push(e.eq(a));i&&n&&r(!0)},onDelete:function(e){var i;for(i=0;i<t.length;i++)if(t[i].data("id")===e.data("id")){t.splice(i,1);break}0===t.length&&s.render()},shiftSelect:function(e){var i,n,l,s;for(s=0;s<t.length;s++)t[s].data("id")!==e.data("id")?t[s].find(o.itemChk).hasClass("item-chked")&&("undefined"==typeof i&&(i=s),n=s):l=s;for(i||(i=l,n=l),l>i?n=l:i=l,m(),s=i;n>=s;s++)a(t[s].find(o.itemChk),!0)},normalSelect:function(e){var t=e.find(o.itemChk),i=n.get("selectedList");0===i.length?a(t,!0):1===i.length&&t.hasClass("item-chked")?a(t,!1):(this.unSelectAll(),a(t,!0))},selectList:function(e){if(e&&e.length){var n,a,l;for(n=0;n<t.length;n++)for(l=t[n].data("id"),a=0;a<e.length;a++)l.toString()===e[a].toString()&&this.select(t[n].find(o.itemChk),!0);e.length===t.length&&(i=!0)}}};return k}(),w=function(){c.delegate(o.item,"mouseover",function(e){t(e.target).closest(o.item).addClass("item-hover")}),c.delegate(o.item,"mouseout",function(e){t(e.target).closest(o.item).removeClass("item-hover")}),c.delegate(o.chkAll,"click",function(e){e.stopPropagation(),v.selectAll(),v.calSelected()}),c.delegate(o.itemChk,"click",function(e){e.stopPropagation();var i=t(e.target).closest(o.item),n=i.find(o.itemChk);n.toggleClass("item-chked"),i.toggleClass("item-active"),v.calSelected()}),c.delegate(o.item,"click",function(e){e.stopPropagation();var i=t(e.target),n=i.closest(o.item),a=n.find(o.itemChk);if(l.isShift)v.shiftSelect(n),v.calSelected(n.index());else if(l.isCtrl)v.isChked(a)?v.select(a,!1):v.select(a,!0),v.calSelected(n.index());else if(s.nameClick&&n.hasClass("enabled")){var d=n.attr("data-id");s.nameClick([d])}else v.normalSelect(n),v.calSelected(n.index())}),c.delegate(o.editNameBox,"keyup",function(e){var i=t(e.target);13===e.keyCode&&i.closest(o.item).find(o.editNameSure).trigger("click")}),c.delegate(o.editNameSure,"click",function(e){e.stopPropagation();var i=t(e.target).closest(o.item),n=i.find(o.nameText),a=i.find(o.editName),l=i.find(o.editNameBox),d=i.attr("data-id"),r=t.trim(l.val());return n.html().trim()===r?(a.hide(),n.show(),void 0):(s.rename(d,r,function(){n.html(r),a.hide(),n.show()}),void 0)}),c.delegate(o.editNameCancel,"click",function(e){e.stopPropagation();var i=t(e.target).closest(o.item),n=i.find(o.nameText),a=i.find(o.editName);n.show(),a.hide()}),c.find(o.list).delegate(o.editName,"mousedown",function(e){e.stopPropagation()}),c.find(o.list).delegate(o.newDir,"mousedown",function(e){e.stopPropagation()}),c.delegate(o.newDirBox,"keyup",function(e){13===e.keyCode&&c.find(o.newDirSure).trigger("click")}),c.delegate(o.newDirSure,"click",function(e){e.stopPropagation();var i=t(e.target).closest(o.newDir),a=i.find(o.newDirBox),l=n.get("currentDir");s.newDir(l+"/"+t.trim(a.val()),function(e){f();var t;c.find(o.item).length>0?(t=c.find('div[node-type="item-copy"]').clone(!0),t.attr("data-id",e.fs_id).attr("node-type","item").find('a[node-type="name"]').html(e.name.split("/").pop()),t.show(),c.find(o.item).eq(0).before(t),v.saveItems(t,!0)):s.render()})}),c.delegate(o.newDirCancel,"click",function(e){e.stopPropagation(),f()});var e,i,a=c.find(o.list);a.bind("scroll",function(){var t=this;window.clearTimeout(i),i=window.setTimeout(function(){var i=a.scrollTop(),n=a.height();e=t.scrollHeight,n+i>e-200&&s.loadMore()},100)});var r=null;c.find(o.list).delegate(o.item,"contextmenu",function(e){clearTimeout(r);var i,n,a=t(e.target);return a.closest(o.mod).length&&!a.closest(o.editName).length?(i=a.closest(o.item),n=i.find(o.itemChk),n.hasClass("item-chked")||(v.unSelectAll(),n.addClass("item-chked"),i.addClass("item-active")),v.calSelected(),r=setTimeout(function(){mdev.message.trigger("context-menu-render",e,d)},0),!1):void 0}),t(window).bind("resize",p),c.bind("selectstart",function(){return!1}),c.delegate(o.editName,"click",function(e){e.stopPropagation()}),c.delegate(o.editName,"selectstart",function(e){e.stopPropagation()}),c.delegate(o.newDir,"selectstart",function(e){e.stopPropagation()})},k=c.find(o.loading),y=function(){var e=i.get("render-type");if("grid-view"!==e)return c.hide(),r=!0,void 0;c.find(o.list).html(""),c.show(),r=!1;var t=function(e){e?(c.find(o.list).html("").append(k),k.show()):k.remove()};s.loading&&(s.loading=t),s.setListRenderHandler(g)},b=function(){mdev.message.listen("selected-all",function(e){r||(e?v.selectAll():v.unSelectAll(),v.calSelected())}),mdev.message.listen("file-operate",function(e){if(!r){var t=n.get("selectedList"),i=n.get("selectedItemList");switch(e){case"restore":s.restore(t);break;case"share":s.share(t);break;case"unshare":s.unshare(t);break;case"delete":case"delete-completely":s.del(t,h);break;case"clear-all":s.clearAll();break;case"download":s.download(t);break;case"print":s.print(t);break;case"history":s.history(t);break;case"rename":u(i[0]);break;case"copy":s.copy(t);break;case"move":s.move(t,h);break;case"music":s.musicPlayAll(t);break;case"puzzle":case"prettify":s.meitu(t);break;case"new-dir":m();break;case"push":s.push(t);break;case"push-file":s.push(t);break;case"open":s.nameClick(t[0]);break;case"folder-open":s.folderOpen(t[0])}}}),mdev.message.listen("delete_picture",function(){h()})},C=function(){s=e("clouddisk-ui:widget/list-view/disk-home.js"),w(),b(),i.listen("render-type",y),y()};C()});
;define("clouddisk-ui:widget/header/header.js",function(e){var a=e("common:widget/libs/jquerypacket.js"),d=e("common:widget/hash/hash.js"),r={mod:"div.module-header",wrapper:'div[node-type~="module-header-wrapper"]'},t=a(r.mod),i=function(){window.$=window.jQuery=a;var i="http://yun.baidu.com/ppres/static/thirdparty/header/module_header.js";a.getScript(i,function(){var a={mods:["NAVS","AD","PERSONAL_INFO","NOTICE","DOWNLOAD","MORE"],navCurrent:"网盘",searchBoxPlaceHold:"搜索你的文件",vip:t.data("vip"),nickName:t.data("nick-name"),isLogin:t.data("is-login")},i=e("common:widget/data-center/data-center.js"),o=i.get("page");"disk-home"===o&&a.mods.push("SEARCH_BOX");var n=disk.getParam("frm");if("hao123"==n&&(a.unionLogo=["hao123"]),header=new yunHeader.Header(a),"disk-home"===o){header.listen("searchFormSubmit",function(e){e=e.trim(),d.set("key",e),d.set("path",""),""===e&&d.set("path","/")});var h=d.get("key"),m=d.get("path");m&&""!==m||!h||""===h||header.setSearchFormValue(h)}t.find(r.wrapper).html("").append(header.$el)}),"hao123-iframe"===disk.getParam("frm")&&t.hide()};i()});
;define("clouddisk-ui:widget/home-header/home-header.js",function(n){var e={mod:"div.module-home-header",edit:".personal-edit-btn",sharenum:".sharenum"},t=n("common:widget/libs/jquerypacket.js"),i=t(e.mod),o=t(e.edit),r=t(e.sharenum),a=n("common:widget/commonService/commonService.js"),c=n("common:widget/restApi/restApi.js"),s=n("common:widget/shareCount/shareCount.js"),u={shareEditUserInfo:null},f={_init:function(){this.handle(),this.getUInfo(),this.setShareCount()},setShareCount:function(){var n=r.find(".publiccnt"),e=r.find(".secretcnt"),t=r.find(".albumcnt"),i=r.find(".concerncnt"),o=r.find(".fanscnt");return function(){s.provideShareData({uk:yunData.MYUK,callback:function(r){n.text(r.pubshare_cnt||0),e.text(r.secshare_cnt||0),t.text(r.album||0),i.text(r.follow||0),o.text(r.fans||0)}})}}(),getUInfo:function(){var n=this;t.get(c.normalize(c.GET_UINFO+"?query_uk="+yunData.MYUK,yunData.MYBDSTOKEN),function(e){e=t.parseJSON(e),0===e.errno&&n.userInfo(e.user_info)})},userInf:function(n){i.find(".pic-frm-pic").attr("src",n.avatar_url),i.find(".fanscnt em").html(n.fans_count),i.find(".concerncnt em").html(n.follow_count),i.find(".publiccnt em").html(n.pubshare_count),i.find(".secretcnt em").html(n.pubshare_count),i.find(".albumcnt em").html(n.album_count),i.find(".personal-info").html(n.intro)},handle:function(){o.on({click:function(){var n=i.find(".personal-info").html();null===u.shareEditUserInfo?a.getWidgets("common:widget/shareEditUserInfo/shareEditUserInfo.js",function(e){u.shareEditUserInfo=new e,u.shareEditUserInfo.reBuild(n,function(n){i.find(".personal-info").html(n)})}):u.shareEditUserInfo.reBuild(n,function(n){i.find(".personal-info").html(n)})}})}};t(document).ready(function(){f._init()})});
;define("clouddisk-ui:widget/inbox-manage/share-point-dom-helper.js",function(e,s,i){var a=e("common:widget/libs/jquerypacket.js"),t=mdev.tmpl,l=e("common:widget/category/category.js"),o={};o.TYPE_RECEIVE=1,o.TYPE_SEND=0,o.ONE_DAYS_SECONDS=86400,a.extend(o,{STATUS_UNRECEIVE:1,SUCCESS:2,RECEIVING:3,CHECK_ALL_FAIL:4,CHECK_FAIL_TRANS_SUCCESS:5,CHECK_FAIL_TRANS_FAIL:6,CHECK_FAIL_TRANS_ALL_FAIL:7,CHECK_SUCCESS_TRANS_FAIL:8,CHECK_SUCCESS_TRANS_ALL_FAIL:9,QUOTA_EXCEED:10,TOO_MUCH_FILES:11,FILE_ALL_EXISTS:12,RECEIVING_MID_STATE:20}),o.ICON_TYPE_MAP={Session:"u-type-multi-1",MUS:"u-type-mus",PIC:"u-type-pic",MOV:"u-type-mov",DOC:"u-type-word",APP:"u-type-app",OTH:"u-type-multi-1",Excel:"u-type-excel",Word:"u-type-word",Ppt:"u-type-ppt",Visio:"u-type-visio",Pdf:"u-type-pdf",Doc_oth:"u-type-doc-oth",Apk:"u-type-apk",Exe:"u-type-exe",Ipa:"u-type-ipa",Zip:"u-type-zip",Txt:"u-type-txt",Torrent:"u-type-torrent",BT:"u-type-bt",Default:"u-type-default"},o.getStatusDom=function(e,s,i){if(e!==o.SUCCESS&&0>=s)return'<div class="option-unvalid">&nbsp;</div>';var a;switch(e){case o.STATUS_UNRECEIVE:a=FileUtils.uk==i?"":'<div class="option-receive"><a class="status j-receive-item" href="javascript:;">保存</a></div>';break;case o.SUCCESS:a='<div class="option-received"><em class="u-icon u-icon-ok"></em><span class="txt">已保存</span><a class="view" href="javascript:;">查看</a></div>';break;case o.RECEIVING:a='<div class="option-receiving"><span>保存中...</span></div>';break;case o.RECEIVING_MID_STATE:a='<div class="option-receiving"><span>保存中...</span></div>';break;case o.CHECK_ALL_FAIL:a='<div class="option-fail-delete"><em class="u-icon u-icon-fail"></em><span class="txt">文件已删除</span></div>';break;case o.CHECK_FAIL_TRANS_SUCCESS:a='<div class="option-received"><em class="u-icon u-icon-ok"></em><span class="txt">已保存</span><a class="view" href="javascript:;">查看</a></div>';break;case o.CHECK_FAIL_TRANS_FAIL:a='<div class="option-fail-network"><em class="u-icon u-icon-fail"></em><span class="txt">网络异常</span><a class="status j-receive-item" href="javascript:;">保存</a></div>';break;case o.CHECK_FAIL_TRANS_ALL_FAIL:a='<div class="option-fail-network"><em class="u-icon u-icon-fail"></em><span class="txt">网络异常</span><a class="status j-receive-item" href="javascript:;">保存</a></div>';break;case o.CHECK_SUCCESS_TRANS_FAIL:a='<div class="option-fail-network"><em class="u-icon u-icon-fail"></em><span class="txt">网络异常</span><a class="status j-receive-item" href="javascript:;">保存</a></div>';break;case o.CHECK_SUCCESS_TRANS_ALL_FAIL:a='<div class="option-fail-network"><em class="u-icon u-icon-fail"></em><span class="txt">网络异常</span><a class="status j-receive-item" href="javascript:;">保存</a></div>';break;case o.QUOTA_EXCEED:a='<div class="option-fail-network"><em class="u-icon u-icon-fail"></em><span class="txt">容量不足</span><a class="status j-receive-item" href="javascript:;">保存</a></div>';break;case o.TOO_MUCH_FILES:a='<div class="option-fail-network"><em class="u-icon u-icon-fail"></em><span class="txt">文件数超限</span></div>';break;case o.FILE_ALL_EXISTS:a='<div class="option-fail-exist"><em class="u-icon u-icon-fail"></em><span class="txt">文件已存在</span><a class="status j-receive-item" href="javascript:;">保存</a></div>';break;default:a='<div class="option-fail-network"><em class="u-icon u-icon-fail"></em><span class="txt">网络异常</span><a class="status j-receive-item" href="javascript:;">保存</a></div>'}return a},o.getInitDom=function(){return'<div class="point-content"><div class="content-tp"><span class="total">获取更多数据...</span><div class="all">全部文件</div></div><div class="content-bd"><div class="m-table"><div class="table-thead global-clearfix"></div><div class="table-tbody"><div class="main-list"></div><div class="list-ft global-clearfix"></div></div></div><div class="m-empty"></div></div></div>'},o.getEmptyDom=function(e){var s;return s=e===o.TYPE_RECEIVE?"还没有收到好友分享的文件":"还没有发送文件给你的好友呢",'<div class="empty"><h3 class="title">'+s+'</h3><div class="content"><div class="tip">我可以给好友分享文件：</div><div class="guide"><span class="step1">选中文件，显示“分享”按键</span><span class="step2">选择好友分享</span></div></div></div>'},o.getHeaderReceiveDom=function(){return'<div class="g-col g-col-left g-col-file"><div class="border"><a class="checkbox-wrapper j-check-all" hidefocus="true" href="javascript:;"><span class="u-checkbox"><b class="u-icon u-icon-box"></b></span></a><span class="file-title">文件名</span></div></div><div class="g-col g-col-mid g-col-date"><div class="border"><span>有效时间</span></div></div><div class="g-col g-col-mid g-col-share"><div class="border"><span>分享人</span></div></div><a href="javascript:;" hidefocus="true" class="g-col g-col-right g-col-time g-col-time-down j-sharetime"><span class="border"><span>分享时间</span><span class="action-time"></span></span></a>'},o.getHeaderSendDom=function(){return'<div class="g-col g-col-left g-col-file"><div class="border"><a class="checkbox-wrapper j-check-all" hidefocus="true" href="javascript:;"><span class="u-checkbox"><b class="u-icon u-icon-box"></b></span></a><span class="file-title" style="margin-left: 0;">分享文件</span></div></div><div class="g-col g-col-mid g-col-receiver"><div class="border"><span>收件人</span></div></div><div class="g-col g-col-mid g-col-date"><div class="border"><span>有效时间</span></div></div><a href="javascript:;" class="g-col g-col-right g-col-time g-col-time-down j-sharetime"><span class="border"><span>分享时间</span><span class="action-time"></span></span></a>'},o.parseList=function(e){var s={formatVTime:function(e){return 0>=e?"已过期":Math.ceil(e/o.ONE_DAYS_SECONDS)+"天"},formateFileTittle:function(e,s,i){var a="";if(0>=s)return"";switch(e){case o.STATUS_UNRECEIVE:FileUtils.uk!=i&&(a=" fn-bold");break;case o.CHECK_FAIL_TRANS_FAIL:a=" fn-bold";break;case o.CHECK_FAIL_TRANS_ALL_FAIL:a=" fn-bold";break;case o.CHECK_SUCCESS_TRANS_FAIL:a=" fn-bold";break;case o.CHECK_SUCCESS_TRANS_ALL_FAIL:a=" fn-bold";break;default:a=""}return a},toDateString:function(e){var s=new Date;s.setTime(1e3*e);var i=s.getMonth()+1,a=s.getDate(),t=s.getHours(),l=s.getMinutes();return s.getFullYear()+"-"+(String(i).length<2?"0"+i:i)+"-"+(String(a).length<2?"0"+a:a)+" "+(String(t).length<2?"0"+t:t)+":"+(String(l).length<2?"0"+l:l)},getCategoryClass:function(e,s,i){var a;if("string"==typeof e&&(e=win.parseInt(e,10)),6===e&&0===s){if(void 0!==i){var t=i.substring(i.lastIndexOf(".")+1);return"u-type-"+t.toLowerCase()}return"u-type-default"}if(4===e&&void 0!==i){var t=i.substring(i.lastIndexOf(".")+1);return"u-type-"+t.toLowerCase()}if(7===e)return"u-type-torrent";switch(e){case 0:a=o.ICON_TYPE_MAP.Session;break;case l.MUS:a=o.ICON_TYPE_MAP.MUS;break;case l.PIC:a=o.ICON_TYPE_MAP.PIC;break;case l.MOV:a=o.ICON_TYPE_MAP.MOV;break;case l.DOC:a=o.ICON_TYPE_MAP.DOC;break;case l.APP:a=o.ICON_TYPE_MAP.APP;break;case l.OTH:a=o.ICON_TYPE_MAP.OTH;break;case l.Excel:a=o.ICON_TYPE_MAP.Excel;break;case l.Word:a=o.ICON_TYPE_MAP.Word;break;case l.Ppt:a=o.ICON_TYPE_MAP.Ppt;break;case l.Visio:a=o.ICON_TYPE_MAP.Visio;break;case l.Pdf:a=o.ICON_TYPE_MAP.Pdf;break;case l.Doc_oth:a=o.ICON_TYPE_MAP.Doc_oth;break;case l.Apk:a=o.ICON_TYPE_MAP.Apk;break;case l.Exe:a=o.ICON_TYPE_MAP.Exe;break;case l.Ipa:a=o.ICON_TYPE_MAP.Ipa;break;case l.Zip:a=o.ICON_TYPE_MAP.Zip;break;case l.Txt:a=o.ICON_TYPE_MAP.Txt;break;case l.Torrent:a=o.ICON_TYPE_MAP.Torrent;break;case l.BT:a=o.ICON_TYPE_MAP.BT;break;default:a=o.ICON_TYPE_MAP.Default}return a},getStatusDom:o.getStatusDom},i='<% if (file.joined_status != 4) { %><% if (file.last_time > 0) { %><% if (file.session_category == 0) { %><span class="u-type u-type-multi-1"></span><a class="file-title" href="javascript:;"><%- file.session_title %></a><% } else if (file.session_category == 1 ) { %><span class="u-type u-type-mov %>"></span><a class="file-title-mov" target="_blank" href="/inbox/streampage?type=3&object_id=<%- file.object_info.object_id %>&session_id=<%- file.session_id %>&fs_id=<%- file.object_info.fs_id %>&founder_uk=<%- file.founder_uk %>&filename=<%- file.session_title %>&box_type=<%- obj.type %>"><%- file.session_title %></a><% } else if (file.session_category == 2 || file.session_category == 3 || file.session_category == 4) { %><span class="u-type <%- obj.helper.getCategoryClass(file.session_category, file.object_info && file.object_info.isdir, file.session_title) %>"></span><a class="file-title" href="javascript:;"><%- file.session_title %></a><% } else if (file.session_category == 5) { %><span class="u-type <%- obj.helper.getCategoryClass(file.session_category, file.object_info && file.object_info.isdir) %>"></span><span class="file-title-default"><%- file.session_title %></span><% } else if (file.session_category == 6 && file.object_info.isdir == 1) { %><span class="u-type u-type-multi-1"></span><a class="file-title" href="javascript:;"><%- file.session_title %></a><% } else if (file.session_category == 6 && file.object_info.isdir == 0) { %><span class="u-type u-type-default <%- obj.helper.getCategoryClass(file.session_category, file.object_info && file.object_info.isdir, file.session_title) %>"></span><span class="file-title-default"><%- file.session_title %></span><% } else { %><span class="u-type <%- obj.helper.getCategoryClass(file.session_category, file.object_info && file.object_info.isdir, file.session_title) %>"></span><span class="file-title-default"><%- file.session_title %></span><% } %><% } else { %><span class="u-type <%- obj.helper.getCategoryClass(file.session_category, file.object_info && file.object_info.isdir) %>"></span><span class="file-title-default fn-gray"><%- file.session_title %></span><% } %><% } else { %><span class="u-type <%- obj.helper.getCategoryClass(file.session_category, file.object_info && file.object_info.isdir) %>"></span><span class="file-title-default fn-gray"><%- file.session_title %></span><% } %>',a='<% if (file.category == 1 ) { %><span class="u-type <%- obj.helper.getCategoryClass(file.category) %>"></span><a class="file-title-mov" target="_blank" href="/inbox/streampage?type=3&object_id=<%- file.object_id %>&session_id=<%- obj.session_id %>&fs_id=<%- file.fs_id %>&founder_uk=<%- obj.founder_uk %>&filename=<%- file.server_filename %>&box_type=<%- obj.type %>"><%- file.server_filename %></a><% } else if (file.category == 2 || file.category == 3 || file.category == 4) { %><span class="u-type <%- obj.helper.getCategoryClass(file.category, null, file.server_filename) %>"></span><a class="file-title" href="javascript:;"><%- file.server_filename %></a><% } else if (file.category == 5) { %><span class="u-type <%- obj.helper.getCategoryClass(file.category) %>"></span><span class="file-title-default"><%- file.server_filename %></span><% } else if (file.category == 6 && file.isdir == 1) { %><span class="u-type u-type-multi-1"></span><a class="file-title" href="javascript:;"><%- file.server_filename %></a><% } else if (file.category == 6 && file.isdir == 0) { %><span class="u-type u-type-default <%- obj.helper.getCategoryClass(file.category, file.isdir, file.server_filename) %>"></span><span class="file-title-default"><%- file.server_filename %></span><% } else { %><span class="u-type <%- obj.helper.getCategoryClass(file.category, file.isdir, file.server_filename) %>"></span><span class="file-title-default"><%- file.server_filename %></span><% } %>',t='<!-- 列表 --><dl><!-- 循环 begin --><% $.map(obj.list, function(file, index) { %><dd class="file-item global-clearfix" data-joined-status="<%- file.joined_status %>" data-category=<%- file.session_category %> data-position=<%- index %> data-sessionid=<%- file.session_id %>><div class="g-col g-col-file" title="<%- file.session_title %>"><div class="option"><%= obj.helper.getStatusDom(file.joined_status, file.last_time, file.founder_uk) %></div><div class="file-info<%- obj.helper.formateFileTittle(file.joined_status, file.last_time, file.founder_uk) %>"><a class="checkbox-wrapper j-check-item" hidefocus="true" href="javascript:;"><span class="u-checkbox"><b class="u-icon u-icon-box"></b></span></a>'+i+'</div></div><div class="g-col g-col-other g-col-date"><% if (file.last_time <= 0) { %><span>已过期</span><% } else { %><span class="fn-red"><%- obj.helper.formatVTime(file.last_time) %></span><% } %></div><div class="g-col g-col-other g-col-share"><a target="_blank" class="j-user-name" href="/share/home?uk=<%- file.founder_uk %>"><%- file.founder_uname %></a></div><div class="g-col g-col-other g-col-time"><span><%- obj.helper.toDateString(file.create_time) %></span></div><% if (file.session_desc !== undefined && file.session_desc !== "") { %><div class="metas-box description"><span class="description-txt fn-ellipsis"><%- file.session_desc %></span></div><% } %></dd><% }); %><!-- 循环 end --></dl><!-- /列表 -->',c='<!-- 列表 --><dl><!-- 循环 begin --><% if(typeof obj.baseListNo === "undefined"){ obj.baseListNo = 0; } $.map(obj.list, function(file, index) { %><dd class="file-item global-clearfix" data-category="<%- file.category %>" data-position=<%- index + obj.baseListNo %>><div class="g-col g-col-file" title="<%- file.server_filename %>"><div class="file-info file-info-1"><a class="checkbox-wrapper j-check-item" hidefocus="true" href="javascript:;"><span class="u-checkbox"><b class="u-icon u-icon-box"></b></span></a>'+a+'</div></div><div class="g-col g-col-other g-col-date"><% if (obj.last_time <= 0) { %><span>已过期</span><% } else { %><span class="fn-red"><%- obj.helper.formatVTime(obj.last_time) %></span><% } %></div><div class="g-col g-col-other g-col-share"><a target="_blank" class="j-user-name" href="/share/home?uk=<%- obj.founder_uk %>"><%- obj.founder_uname %></a></div><div class="g-col g-col-other g-col-time"><span><%- obj.helper.toDateString(obj.create_time) %></span></div></dd><% }); %><!-- 循环 end --></dl><!-- /列表 -->',n='<!-- 列表 --><dl><!-- 循环 begin --><% $.map(obj.list, function(file, index) { %><dd class="file-item global-clearfix" data-category=<%- file.session_category %> data-position=<%- index %> data-sessionid=<%- file.session_id %>><div class="g-col g-col-file"><div class="file-info" title="<%- file.session_title %>"><a class="checkbox-wrapper j-check-item" hidefocus="true" href="javascript:;"><span class="u-checkbox"><b class="u-icon u-icon-box"></b></span></a>'+i+'</div></div><div class="g-col g-col-other g-col-receiver" title="<%- file.member_title %>"><span><%- file.member_title %></span></div><div class="g-col g-col-other g-col-date"><% if (file.last_time <= 0) { %><span>已过期</span><% } else { %><span class="fn-red"><%- obj.helper.formatVTime(file.last_time) %></span><% } %></div><div class="g-col g-col-other g-col-time"><span><%- obj.helper.toDateString(file.create_time) %></span></div><div class="metas-box"><div class="receivers fn-hide"><label>收件人（<%- file.member_count %>个）：</label><span><img class="loading" src="/res/static/images/loading.gif" width="14" height="14" /></span></div><div class="description fn-hide"><label>描述：</label><span><img class="loading" src="/res/static/images/loading.gif" width="14" height="14" /></span></div></div></dd><% }); %><!-- 循环 end --></dl><!-- /列表 -->',r='<!-- 列表 --><dl><!-- 循环 begin --><% $.map(obj.list, function(file, index) { %><dd class="file-item global-clearfix" data-category=<%- file.category %> data-position=<%- index + obj.baseListNo %>><div class="g-col g-col-file"><div class="file-info file-info-1" title="<%- file.server_filename %>"><a class="checkbox-wrapper fn-vhidden j-check-item" hidefocus="true" href="javascript:;"><span class="u-checkbox"><b class="u-icon u-icon-box"></b></span></a>'+a+'</div></div><div class="g-col g-col-other g-col-receiver" title="<%- file.member_title %>"><span><%- obj.member_title %></span></div><div class="g-col g-col-other g-col-date"><% if (obj.last_time <= 0) { %><span>已过期</span><% } else { %><span class="fn-red"><%- obj.helper.formatVTime(obj.last_time) %></span><% } %></div><div class="g-col g-col-other g-col-time"><span><%- obj.helper.toDateString(obj.create_time) %></span></div></dd><% }); %><!-- 循环 end --></dl><!-- /列表 -->',f=function(i,a){var l;return l=i===o.TYPE_RECEIVE?t:n,a.type=i,a.helper=s,e(l,a)},d=function(i,a){var t;return t=i===o.TYPE_RECEIVE?c:r,a.type=i,a.helper=s,e(t,a)};return{renderSessionList:f,renderFileInfoList:d}}(t),i.exports=o});
;define("clouddisk-ui:widget/inbox-manage/inbox_dirmanager.js",function(a,t,s){var e=a("common:widget/libs/jquerypacket.js"),n=function(a){this.pathArr=[],this.container=a&&a.container,this.allFileName=a.allFileName||"全部文件",this.initEvent()};n.prototype={constructor:n,initEvent:function(){var a=this;this.container.delegate(".pathStep","click",function(){var t=e(this).data("step");".."===t&&(t=a.pathArr.length-2),t=parseInt(t)+1,a.goTo(t)})},renderHtml:function(){var a,t=this,s=0,e='<span class="all-files">'+t.allFileName+"</span>";if(0===t.pathArr.length)return e;e='<span class="all-files"><a class="pathStep" href="javascript:;" data-step="..">返回上一级</a></span><span class="separate">|</span>',e+='<span class="dirpath"><a class="pathStep" href="javascript:;" data-step="-1">'+t.allFileName+'</a></span><span class="separate">&gt;</span>',t.pathArr.length>3&&(s=t.pathArr.length-3,e+='<span class="dirpath">...</span><span class="separate">&gt;</span>');for(var n=t.pathArr.length-1;n>s;s++)a=t.pathArr[s].server_filename||t.pathArr[s].session_title||"step",e+='<span class="dirpath"><a class="pathStep" href="javascript:;" data-step="'+s+'" title="'+a+'">'+a.toEntity()+'</a></span><span class="separate">&gt;</span>';return a=t.pathArr[s].server_filename||t.pathArr[s].session_title||"step",e+='<span class="dirpath">'+a.toEntity()+"</span>"},goTo:function(a){var t=this;if(0===a)t.pathArr.length=0;else if("number"==typeof a&&t.pathArr.length-1>=a)t.pathArr.splice(a);else{if("object"!=typeof a||!a.session_id)return console.log("[WARN] this dir object is invalid [send by inboxDirManager]"),void 0;t.pathArr.length&&t.pathArr[0].session_id===a.session_id?t.pathArr.push(a):(t.pathArr.length=0,t.pathArr.push(a))}t.build(),t.changePath()},build:function(){this.container.html(this.renderHtml())},changeAllFileName:function(a){"string"==typeof a&&(this.allFileName=a)},changePath:function(){var a=this;a.onPathChange&&a.onPathChange.call(a,a.pathArr[a.pathArr.length-1])}},s.exports=n});
;define("clouddisk-ui:widget/inbox-manage/inbox-manage.js",function(e){var i=e("common:widget/libs/jquerypacket.js"),s=(mdev.tmpl,e("clouddisk-ui:widget/inbox-manage/share-point-dom-helper.js")),t=e("common:widget/toast/toast.js"),a=e("common:widget/panel/panel.js"),n=e("common:widget/commonService/commonService.js"),o=e("clouddisk-ui:widget/inbox-manage/inbox_dirmanager.js"),l=e("common:widget/category/category.js"),r=e("common:widget/dialog/dialog.js"),c=function(e){this._mImgPreviewer=null,this._mMboxPlayer=null,this._mDocumentReader=null,this._mDirManager=null,this._mLoopStep=[2,3,5,8,10],this._mLoopCurrentStep=0,this.listEnd=!1,this.isRequiring=!1,this._mPicList=[],this._mElementDatas=[],this._isSession=!0,this._isSelfShare=!1,this.cache={listSessionCountOfLoaded:0,listSessionCount:0},this._mDatasReceive={selectedSessionIdArray:[],sessionToDDs:{},sessionToVDays:{},validDaysArray:[]},this._mDatasSend={selectedSessionIdArray:[],sessionToDDs:{}},i.extend(this,c.defaultConfig,e),this._init()};c.defaultConfig={type:1,$container:i("#pointContainer"),start:0,limit:20,currentPageNum:1},i.extend(c,{URL_LIST:"/inbox/object/list",URL_DELETE:"/inbox/object/delete",URL_METAS:"/inbox/object/sharemetas",URL_FILEINFO:"/inbox/object/fileinfo",URL_RECEIVE:"/inbox/object/receive",URL_PARTLIST:"/inbox/object/partlist",URL_GETPATH:"/inbox/object/getpath",URL_TRANSFER:"/inbox/object/transfer",TYPE_RECEIVE:1,TYPE_SEND:0,MSG_SUCCESS:"",MSG_ERROR_SERVER:"发生未知错误，请稍候重试",ERRNO_FILE_NOT_EXISTS:-69}),c.showErrorTip=function(){t.obtain.useToast({toastMode:t.obtain.MODE_CAUTION,msg:c.MSG_ERROR_SERVER,sticky:!0,position:a.TOP,closeType:!0})},c.prototype={constructor:c,_init:function(){this._initHeader(),this._loadingHeader(),this._resizeListHeight(),this._installDirManager(),this._bindFixed()},_resizeListHeight:function(){var e=i(window).height(),s=this.$module.find(".table-tbody"),t=s.offset().top;s.height(e-t)},_initHeader:function(){i(".module-crumbs").remove(),i(".module-list-toolbar").remove(),i(".module-list-view").remove(),i("#pointContainer")[0]||i(".module-share-manage-header").after('<div id="pointContainer" class="module-point"></div>'),this.$container=i("#pointContainer"),this.$container.html(s.getInitDom()),this.$module=this.$container.find(".m-table")},_loadingHeader:function(){var e=this;e._mPicList=[],this.$container.find(".total").html("获取更多数据..."),this.$container.find(".content-tp").removeClass("fn-hide"),this.type===c.TYPE_RECEIVE?(this.$module.attr("class","m-table m-receive"),this.$module.find(".table-thead").html(s.getHeaderReceiveDom())):(this.$module.attr("class","m-table m-send"),this.$module.find(".table-thead").html(s.getHeaderSendDom())),this.$container.find(".m-empty")[0]&&(this.$container.find(".m-empty").hide(),this.$module.show()),this.$module.find(".main-list").html('<div class="empty-tip">正在加载数据，请稍后...</div>')},_installDirManager:function(){var e=this;null===this._mDirManager&&(this._mDirManager=new o({container:this.$container.find(".content-tp .all")}),this._mDirManager.onPathChange=function(i){i?(e.start=0,e._ajaxFileinfo(i,function(){})):(e.start=0,e._ajaxList({renderType:"list"}))})},tab:function(e,i){this.type=e,this.userType=i,this.start=0,this._mDirManager.goTo(0),this.type===c.TYPE_RECEIVE?n.diskLog.send({type:"module_p2p_session",val:"receive_list"}):n.diskLog.send({type:"module_p2p_session",val:"send_list"})},_isNeedScroll:function(){return this.isRequiring===!0?!1:this.cache.listSessionCountOfLoaded>=this.cache.listSessionCount?(disk.DEBUG===!1&&console.log("%c[_ajaxList] list to end ....","background-color: orange; color: white;"),!1):(this.start=this.cache.listSessionCountOfLoaded,disk.DEBUG===!1&&console.log("%c[_ajaxList] list scroll .... and the start is "+this.start,"color: purple"),!0)},_resetCacheData:function(){this._mElementDatas=[],this.cache={listSessionCountOfLoaded:0,listSessionCount:0}},_ajaxList:function(e){var s=this;if(this._isSession=!0,"scroll"===e.renderType){if(this.isRequiring===!0)return!1;if(this.cache.listSessionCountOfLoaded>=this.cache.listSessionCount)return disk.DEBUG===!1&&console.log("%c[_ajaxList] list to end ....","background-color: orange; color: white;"),!1;this.start=this.cache.listSessionCountOfLoaded,this.isRequiring=!0,disk.DEBUG===!1&&console.log("%c[_ajaxList] list scroll .... and the start is "+this.start,"color: purple")}0===s.start&&(s._loadingHeader(),s._resetCacheData()),i.ajax({url:c.URL_LIST,type:"GET",data:{type:this.type,user_type:this.userType,start:this.start,limit:this.limit},cache:!1,dataType:"JSON",success:function(e){s._doDataSessionList(e),s.isRequiring=!1},error:function(){c.showErrorTip(),s._resetHeader(),disk.DEBUG&&console.log("AJAX "+c.URL_LIST+" ERROR !")}})},_changeLoadedNum:function(){this.$container.find(".total").html("已加载"+this.cache.listSessionCountOfLoaded+"个")},_cacheSessionListData:function(){var e,t,a={},n={},o=[],r=this;r.type===c.TYPE_RECEIVE?(r.$module.find("dd.file-item").each(function(){t=i(this),e=r._mElementDatas[t.data("position")],a[t.attr("data-sessionid")]=t,n[t.attr("data-sessionid")]=Math.ceil(e.last_time/s.ONE_DAYS_SECONDS),e.session_category==l.PIC&&e.last_time>0&&(t.attr("data-pic-index",o.length),e.object_info.server_filename=e.session_title,o.push(e.object_info))}),r._mDatasReceive.sessionToDDs=a,r._mDatasReceive.sessionToVDays=n,r._mPicList=o):(r.$module.find("dd.file-item").each(function(){t=i(this),e=r._mElementDatas[t.data("position")],a[t.attr("data-sessionid")]=t,e.session_category==l.PIC&&e.last_time>0&&(t.attr("data-pic-index",o.length),e.object_info.server_filename=e.session_title,o.push(e.object_info))}),r._mDatasSend.sessionToDDs=a,r._mPicList=o)},_doDataSessionList:function(e){var i=this;if(0===e.errno)if(0!==e.cnt){if(i.cache.listSessionCount=e.cnt,i.cache.listSessionCountOfLoaded<=i.cache.listSessionCount){i._mElementDatas=i._mElementDatas.concat(e.list),i.cache.listSessionCountOfLoaded=i._mElementDatas.length,i._bind(),i._changeLoadedNum();var t=s.parseList.renderSessionList(i.type,e);i.$module.find(".main-list").append(t),i.$container.find(".m-empty").hide(),i.$container.find(".empty-tip").hide(),i.$module.show(),i._cacheSessionListData()}}else i.$container.find(".content-tp").addClass("fn-hide"),i.$module.hide(),i.$container.find(".m-empty").html(s.getEmptyDom(i.type)).show();else disk.DEBUG&&console.log("AJAX "+c.URL_LIST+" fail and the errno is "+e.errno),c.showErrorTip(),i._resetHeader()},_resetHeader:function(){return this.$container.find(".main-list>dl").length?(this.$container.find(".u-btn-receive").length>0&&this.$container.find(".u-btn-receive").removeClass("u-btn-receiving").removeClass("u-btn-received").find("b").text("保存"),void 0):(this.$container.find(".m-table").css("display","block"),this.$container.find(".total").html("已加载0条"),this.$container.find(".main-list").html('<div class="empty-tip">数据加载发生错误</div>'),void 0)},_getElementData:function(e){return this._mElementDatas[e]},_freshBrowser:function(){var e=new r;that=this,e.setVisible(!0),e.setMessage("确认离开","你正在保存文件，确定要离开此页码？",function(){this.setVisible(!1)})},_changeCheckAllBtn:function(){var e=this;0!==e.$container.find(".j-receive-item").length?e.$container.find(".j-receive-all").removeClass("u-btn-receiving").removeClass("u-btn-received").find("b").text("保存"):e.$container.find(".j-receive-all").addClass("u-btn-received").removeClass("u-btn-receiving").find("b").text("保存")},_ajaxLoop:function(){var e=this;return 0===e._mDatasReceive.selectedSessionIdArray.length?(disk.DEBUG&&console.log("[AJAX]"+c.URL_PARTLIST+" selectedSessionIdArray is empty, loop stoped ..."),void 0):(disk.DEBUG&&console.log("[AJAX]"+c.URL_PARTLIST+" start loop ..."),i.ajax({url:c.URL_PARTLIST,type:"GET",data:{type:e.type,session_array:i.stringify(e._mDatasReceive.selectedSessionIdArray)},dataType:"JSON",success:function(n){if(0===n.errno){var o=n.session_list.length,l=!1;if(1===o&&l===!1){var r=n.session_list[0],d=e._mDatasReceive.sessionToDDs[r.session_id];d.find(".option").html(s.getStatusDom(r.joined_status)),disk.DEBUG&&console.log("单文件轮训... session_id = "+r.session_id),r.last_time<=0&&(d.find(".g-col-date span").text("已过期"),d.find(".file-title, file-title-default").addClass("fn-gray")),e._mElementDatas[d.data("position")]=r,e._changeCheckAllBtn(),r.joined_status===s.SUCCESS||r.joined_status===s.CHECK_FAIL_TRANS_SUCCESS?(t.obtain.useToast({toastMode:t.obtain.MODE_SUCCESS,msg:'保存成功，<a href="/disk/home#dir/path='+encodeURIComponent(e.path||"/")+'">点击查看</a>',sticky:!0,position:a.TOP,closeType:!0}),e._mDatasReceive.selectedSessionIdArray=_.difference(e._mDatasReceive.selectedSessionIdArray,[r.session_id]),d.data("hasChecked")===!0&&d.trigger("click.fileItem"),0===e._mDatasReceive.selectedSessionIdArray.length&&e._stopLoop(),disk.DEBUG&&console.log("[sharePointHelper.SUCCESS, sharePointHelper.CHECK_FAIL_TRANS_SUCCESS] The joined_status is "+r.joined_status)):r.joined_status===s.CHECK_ALL_FAIL?(t.obtain.useToast({toastMode:t.obtain.MODE_CAUTION,msg:"保存失败，发件人已删除文件，下次早点哦",sticky:!0,position:a.TOP,closeType:!0}),d.find(".file-title, file-title-default").addClass("fn-gray"),e._mDatasReceive.selectedSessionIdArray=_.difference(e._mDatasReceive.selectedSessionIdArray,[r.session_id]),d.data("hasChecked")===!0&&d.trigger("click.fileItem"),0===e._mDatasReceive.selectedSessionIdArray.length&&e._stopLoop(),disk.DEBUG&&console.log("[sharePointHelper.CHECK_ALL_FAIL] The joined_status is "+r.joined_status)):r.joined_status===s.RECEIVING||r.joined_status===s.RECEIVING_MID_STATE?disk.DEBUG&&console.log("[sharePointHelper.RECEIVING] The joined_status is "+r.joined_status):r.joined_status===s.STATUS_UNRECEIVE?disk.DEBUG&&console.log("[sharePointHelper.STATUS_UNRECEIVE] The joined_status is "+r.joined_status):r.joined_status===s.QUOTA_EXCEED?(t.obtain.useToast({toastMode:t.obtain.MODE_CAUTION,msg:'你的网盘容量不足，请到会员中心<a href="/buy/center?tag=2" target="_blank">购买容量</a>',sticky:!0,position:a.TOP,closeType:!0}),e._mDatasReceive.selectedSessionIdArray=_.difference(e._mDatasReceive.selectedSessionIdArray,[r.session_id]),d.data("hasChecked")===!0&&d.trigger("click.fileItem"),0===e._mDatasReceive.selectedSessionIdArray.length&&e._stopLoop(),disk.DEBUG&&console.log("[sharePointHelper.QUOTA_EXCEED] The joined_status is "+r.joined_status)):r.joined_status===s.TOO_MUCH_FILES?(t.obtain.useToast({toastMode:t.obtain.MODE_CAUTION,msg:"文件数超出10000个，减少一些分批保存吧",sticky:!0,position:a.TOP,closeType:!0}),e._mDatasReceive.selectedSessionIdArray=_.difference(e._mDatasReceive.selectedSessionIdArray,[r.session_id]),d.data("hasChecked")===!0&&d.trigger("click.fileItem"),0===e._mDatasReceive.selectedSessionIdArray.length&&e._stopLoop(),disk.DEBUG&&console.log("[sharePointHelper.TOO_MUCH_FILES] The joined_status is "+r.joined_status)):r.joined_status===s.FILE_ALL_EXISTS?(t.obtain.useToast({toastMode:t.obtain.MODE_CAUTION,msg:"保存失败，文件已存在，换个路径保存吧",sticky:!0,position:a.TOP,closeType:!0}),e._mDatasReceive.selectedSessionIdArray=_.difference(e._mDatasReceive.selectedSessionIdArray,[r.session_id]),d.data("hasChecked")===!0&&d.trigger("click.fileItem"),0===e._mDatasReceive.selectedSessionIdArray.length&&e._stopLoop(),disk.DEBUG&&console.log("[sharePointHelper.FILE_ALL_EXISTS] The joined_status is "+r.joined_status)):(t.obtain.useToast({toastMode:t.obtain.MODE_CAUTION,msg:"保存失败，网络异常，检查网络后重新保存",sticky:!0,position:a.TOP,closeType:!0}),e._mDatasReceive.selectedSessionIdArray=_.difference(e._mDatasReceive.selectedSessionIdArray,[r.session_id]),d.data("hasChecked")===!0&&d.trigger("click.fileItem"),0===e._mDatasReceive.selectedSessionIdArray.length&&e._stopLoop(),disk.DEBUG&&console.log("[SharePoint.OTHERS] The joined_status is "+r.joined_status))}else l=!0,disk.DEBUG&&console.log("多文件轮训... session_id Array is "+n.session_list),i.map(n.session_list,function(i){var t=e._mDatasReceive.sessionToDDs[i.session_id];t.find(".option").html(s.getStatusDom(i.joined_status)),e._mElementDatas[t.data("position")]=i,i.joined_status===s.RECEIVING||i.joined_status===s.RECEIVING_MID_STATE||(i.joined_status===s.SUCCESS?(e._mDatasReceive.selectedSessionIdArray=_.difference(e._mDatasReceive.selectedSessionIdArray,[i.session_id]),t.data("hasChecked")===!0&&t.trigger("click.fileItem")):(e.hasError===!1&&(e.hasError=!0),e._mDatasReceive.selectedSessionIdArray=_.difference(e._mDatasReceive.selectedSessionIdArray,[i.session_id]),t.data("hasChecked")===!0&&t.trigger("click.fileItem")))}),0===e._mDatasReceive.selectedSessionIdArray.length&&(e.hasError===!0?(t.obtain.useToast({toastMode:t.obtain.MODE_CAUTION,msg:"部分保存失败，请检查",sticky:!0,position:a.TOP,closeType:!0}),disk.DEBUG&&console.log("部分保存失败，请检查")):(t.obtain.useToast({toastMode:t.obtain.MODE_SUCCESS,msg:'保存成功，<a href="/disk/home#dir/path='+encodeURIComponent(e.path||"/")+'">点击查看</a>',sticky:!0,position:a.TOP,closeType:!0}),disk.DEBUG&&console.log("全部保存成功")),l=!1,e.hasError=!1,e._stopLoop(),e._changeCheckAllBtn())}else disk.DEBUG&&console.log("AJAX "+c.URL_PARTLIST+" fail and the errno is "+n.errno),c.showErrorTip(),e._resetHeader(),e._resetSaveBtn(),e._stopLoop()},error:function(){disk.DEBUG&&console.log("AJAX "+c.URL_PARTLIST+" ERROR !")}}),void 0)},_resetSaveBtn:function(){this.$module.find(".option-receive, .option-receiving").replaceWith(s.getStatusDom(s.STATUS_UNRECEIVE))},_startLoop:function(){var e=this;this._mLoopCurrentStep=0,this.timeId||(e.hasError=!1,function(){var i=arguments.callee,s=e._mLoopStep[e._mLoopCurrentStep]||e._mLoopStep[e._mLoopStep.length-1];disk.DEBUG&&console.log("[LOG] loop at times:",e._mLoopCurrentStep," & time:",s,"s"),e.timeId=setTimeout(function(){e._ajaxLoop(),i()},1e3*s),e._mLoopCurrentStep++}())},_stopLoop:function(){this._mLoopCurrentStep=0,void 0!==this.timeId&&(clearInterval(this.timeId),this.timeId=void 0),disk.DEBUG&&console.log("LOOP STOP ..."),this._mDatasReceive.selectedSessionIdArray=[]},_ajaxReceive:function(){var e=this;disk.DEBUG&&console.log("this._mDatasReceive.selectedSessionIdArray is "+this._mDatasReceive.selectedSessionIdArray),i.ajax({url:c.URL_RECEIVE,type:"GET",data:{session_array:i.stringify(this._mDatasReceive.selectedSessionIdArray),path:e.path,valid_days_array:i.stringify(this._mDatasReceive.validDaysArray)},dataType:"JSON",success:function(i){0===i.errno?0!==e._mDatasReceive.selectedSessionIdArray.length&&e._startLoop():(disk.DEBUG&&console.log("AJAX "+c.URL_RECEIVE+" fail and the errno is "+i.errno),c.showErrorTip(),e._resetHeader(),e._resetSaveBtn(),e._mDatasReceive.selectedSessionIdArray=[])},error:function(){disk.DEBUG&&console.log("AJAX "+c.URL_RECEIVE+" ERROR !"),c.showErrorTip(),e._resetHeader(),e._mDatasReceive.selectedSessionIdArray=[]}})},_ajaxTransfer:function(e,s){i.ajax({url:c.URL_TRANSFER,type:"GET",data:e,dataType:"JSON",success:function(e){"function"==typeof s&&s(e)},error:function(){disk.DEBUG&&console.log("AJAX "+c.URL_TRANSFER+" ERROR !"),c.showErrorTip()}})},_changeOption:function(e){var s;if(this.type===c.TYPE_RECEIVE)if(0!==e){var t=this._isSession===!0?"j-receive-all":"j-receive-all-new";s=i('<div class="option"><a class="checkbox-wrapper j-check-all" hidefocus="true" href="javascript:;"><span class="u-checkbox"><b class="u-icon u-icon-box"></b></span></a><span class="option-tip">已选中<em class="check-num">'+e+'</em>个文件/文件夹</span><span class="btn-wrapper"><a class="u-btn u-btn-receive '+t+'" hidefocus="true" href="javascript:;"><em></em><b>保存</b></a><a class="u-btn u-btn-delete j-delete-all" hidefocus="true" href="javascript:;"><em></em><b>删除</b></a></span></div>')}else s=i('<div class="g-col g-col-left g-col-file"><div class="border"><a class="checkbox-wrapper j-check-all" hidefocus="true" href="javascript:;"><span class="u-checkbox"><b class="u-icon u-icon-box"></b></span></a><span class="file-title">文件名</span></div></div><div class="g-col g-col-mid g-col-date"><div class="border"><span>有效时间</span></div></div><div class="g-col g-col-mid g-col-share"><div class="border"><span>分享人</span></div></div><a href="javascript:;" class="g-col g-col-right g-col-time g-col-time-down j-sharetime"><span class="border"><span>分享时间</span><span class="action-time"></span></span></a>');else this.type===c.TYPE_SEND&&(s=0!==e?i('<div class="option"><a class="checkbox-wrapper j-check-all" hidefocus="true" href="javascript:;"><span class="u-checkbox"><b class="u-icon u-icon-box"></b></span></a><span class="option-tip">已选中<em class="check-num">'+e+'</em>个文件/文件夹</span><span class="btn-wrapper"><a class="u-btn u-btn-delete j-delete-all" hidefocus="true" href="javascript:;"><em></em><b>删除</b></a></span></div>'):i('<div class="g-col g-col-left g-col-file"><div class="border"><a class="checkbox-wrapper j-check-all" hidefocus="true" href="javascript:;"><span class="u-checkbox"><b class="u-icon u-icon-box"></b></span></a><span class="file-title" style="margin-left: 0;">分享文件</span></div></div><div class="g-col g-col-mid g-col-receiver"><div class="border"><span>收件人</span></div></div><div class="g-col g-col-mid g-col-date"><div class="border"><span>有效时间</span></div></div><a href="javascript:;" hidefocus="true" class="g-col g-col-right g-col-time g-col-time-down j-sharetime"><span class="border"><span>分享时间</span><span class="action-time"></span></span></a>'));if(s.find(".j-receive-all, .j-receive-all-new")[0])if(this._isSession===!0){var a=!1;this.$container.find("dd.file-item").each(function(){var e=i(this);return e.find(".u-icon-box").hasClass("u-icon-selected")===!0&&e.find(".j-receive-item")[0]?(a=!0,void 0):void 0}),a===!1&&s.find(".j-receive-all, .j-receive-all-new").addClass("u-btn-disabled")}else this._isSelfShare===!0&&s.find(".j-receive-all, .j-receive-all-new").addClass("u-btn-disabled"),s.find(".j-delete-all").remove();this.$container.find(".table-thead").html(s)},_changeCheckNum:function(e){this.$container.find(".table-thead .check-num").text(e)},_getSessionIdArray:function(){var e,s=[];return this.$module.find("dd.file-item").each(function(){e=i(this),e.find(".u-icon-box").hasClass("u-icon-selected")===!0&&s.push(e.attr("data-sessionid"))}),s},_checkItemToAll:function(){var e=this.$container.find("dd.file-item"),i=this.$container.find("dd.file-item").length,s=e.find(".u-icon-selected").length;this._changeOption(s),i===s?this.$container.find(".j-check-all").find(".u-icon-box").addClass("u-icon-selected"):this.$container.find(".j-check-all").find(".u-icon-box").removeClass("u-icon-selected")},_getCheckedItems:function(){var e=[],s=this;return this.$container.find("dd.file-item").each(function(){var t=i(this);if(t.find(".u-icon-box").hasClass("u-icon-selected")===!0){var a=t.data("position"),n=s._getElementData(a);e.push(n)}}),e},_getTransferParams:function(e){var s=[],t=[],a=this;return this.$container.find("dd.file-item").each(function(){var e=i(this);if(e.find(".u-icon-box").hasClass("u-icon-selected")===!0){var n=e.data("position"),o=a._getElementData(n);s.push(o.object_id+""),t.push(o.fs_id)}}),disk.DEBUG&&(console.log("[ALL TRANSFER CLICK] object_array IS "+s),console.log("[ALL TRANSFER CLICK] fsid_array IS "+t)),{path:e,object_array:i.stringify(_.union(s)),fsid_array:i.stringify(t),session_id:this._sessionIdForFileinfoTransfer,founder_uk:this._founderUkForFileinfoTransfer}},_hasTransferError:function(e){var i=!1;return null==e?(this.useToast(t.obtain.MODE_CAUTION,"网络错误，请稍候重试",!1),i=!0):-6==e.errno?(t.obtain.setVisible(!1),disk.PassportInit.netdiskLogin({reload:!0}),i=!0):-8==e.errno?(this.useToast(t.obtain.MODE_CAUTION,"文件已存在，不用转给自己啦",!1),i=!0):-10==e.errno?(this.useToast(t.obtain.MODE_CAUTION,'你的网盘容量不足，请到会员中心<a href="/buy/center?tag=2" target="_blank">购买容量</a>',!0),i=!0):-33==e.errno?(this.useToast(disk.ui.Toast.MODE_CAUTION,"操作的文件过多，请减少文件后重试",!1),i=!0):0!=e.errno&&(this.useToast(t.obtain.MODE_CAUTION,"保存失败，请稍候重试",!1),i=!0),i},useToast:function(e,i,s,n){t.obtain.useToast({toastMode:e,msg:i,sticky:s,position:a.TOP,closeType:n})},_doTransfer:function(){var e,i=this,s=function(e){i.useToast(t.obtain.MODE_SUCCESS,"保存成功，<a style='color:blue;text-decoration:underline' href='http://pan.baidu.com/disk/home#dir/path="+encodeURIComponent(e)+"'>点击查看</a>保存的文件",!0,!0)},a=this._getCheckedItems();return 0===a.length?(t.obtain.useToast({toastMode:t.obtain.MODE_CAUTION,msg:"您还没有选择保存的文件",sticky:!0,closeType:!0}),!0):(1===a.length&&(e=1===a[0].category?1:0),"1"!=FileUtils.loginState?(Utilities.useCloseToast(),disk.PassportInit.netdiskLogin({reload:!0})):(FileUtils._mMoveSaveDialog||(FileUtils._mMoveSaveDialog=new disk.ui.MoveSaveDialog),FileUtils._mMoveSaveDialog.onConsent=function(e){var t=i._getTransferParams(e||"/");i._ajaxTransfer(t,function(t){i._hasTransferError(t)===!1&&("undefined"!=typeof t.task_id?i._ajaxResolveTransFerFiles(t.task_id,e):s(e))})},FileUtils._mMoveSaveDialog.setVisible(!0)),void 0)},_ajaxResolveTransFerFiles:function(e,s){t.obtain.useToast({toastMode:t.obtain.MODE_LOADING,msg:"系统正在为你保存，请稍候&hellip;",position:a.TOP,sticky:!0});var n=setInterval(function(){i.get("/share/taskquery?taskid="+e,function(e){var e=i.parseJSON(e);if(!e)return t.obtain.useToast({toastMode:t.obtain.MODE_CAUTION,position:a.TOP,msg:"网络错误，请稍候重试",sticky:!0,closeType:!0}),clearInterval(n),void 0;if(0==e.errno)if(0!=e.task_errno){var o="";o=-30==e.task_errno?"保存的文件部分已存在，<a style='color:blue;text-decoration:underline' href='http://pan.baidu.com/disk/home#dir/path="+encodeURIComponent(s||"/")+"'>点击查看</a>已存在的文件":disk.util.shareErrorMessage[e.task_errno]||"文件保存失败，请稍候重试",t.obtain.useToast({toastMode:t.obtain.MODE_CAUTION,msg:o,sticky:!0,position:a.TOP,closeType:!0}),clearInterval(n)}else if("pending"==e.status)t.obtain.useToast({toastMode:t.obtain.MODE_LOADING,msg:"正在准备保存，请稍候&hellip;",sticky:!0,position:a.TOP,closeType:!1});else if("running"==e.status){var l=0;e.progress&&(l=Math.min(Math.max(parseInt(e.progress,10),0),100)),t.obtain.useToast({toastMode:t.obtain.MODE_LOADING,msg:"正在保存，请稍候&hellip;&nbsp;&nbsp;&nbsp;已完成："+l+"%",sticky:!0,position:a.TOP,closeType:!1})}else"success"==e.status?(t.obtain.useToast({toastMode:t.obtain.MODE_SUCCESS,msg:"保存成功，<a style='color:blue;text-decoration:underline' href='http://pan.baidu.com/disk/home#dir/path="+encodeURIComponent(s||"/")+"'>点击查看</a>保存的文件",sticky:!0,position:a.TOP,closeType:!0}),clearInterval(n)):(t.obtain.useToast({toastMode:t.obtain.MODE_CAUTION,msg:"文件保存失败，请稍候重试",sticky:!0,position:a.TOP,closeType:!0}),clearInterval(n));else t.obtain.useToast({toastMode:t.obtain.MODE_CAUTION,msg:disk.util.shareErrorMessage[e.errno]||"文件保存失败，请稍候重试",sticky:!0,position:a.TOP,closeType:!0}),clearInterval(n)})},2500)},_bindFixed:function(){var e=this;i(window).bind("resize",function(){e._resizeListHeight()}),this.$module.find(".table-tbody").unbind("scroll").bind("scroll",function(){var s=i(this);s.find(".main-list").height()-s.find(".list-ft").height()-s.height()-s.scrollTop()<=30&&(disk.DEBUG===!1&&console.log("%c[LOG] file list is scroll. Start loading more ...","color: green;"),e._isSession===!0?e._ajaxList({renderType:"scroll"}):e._ajaxFileinfo())}),this.$container.undelegate(".j-check-all","click.checkAll").delegate(".j-check-all","click.checkAll",function(){var s=i(this),t=e.$container.find("dd.file-item"),a=t.length;s.find(".u-icon-box").hasClass("u-icon-selected")===!1?(t.data("hasChecked",!0).find(".u-icon-box").addClass("u-icon-selected"),e._changeOption(a),e.$container.find(".j-check-all .u-icon-box").addClass("u-icon-selected")):(t.data("hasChecked",!1).find(".u-icon-box").removeClass("u-icon-selected"),s.find(".u-icon-box").removeClass("u-icon-selected"),e._changeOption(0))}),this.$container.undelegate(".j-check-item","click.checkItem").delegate(".j-check-item","click.checkItem",function(s){s.stopPropagation();{var t=i(this),a=t.closest("dd.file-item");e.$module.find("dd.file-item").length}t.find(".u-icon-box").hasClass("u-icon-selected")===!1?(a.data("hasChecked",!0).addClass("file-item-selected"),t.find(".u-icon-box").addClass("u-icon-selected")):(a.data("hasChecked",!1).removeClass("file-item-selected"),t.find(".u-icon-box").removeClass("u-icon-selected")),e._mMoreOptionsDropDown.hide(),e._checkItemToAll()}),this.$container.undelegate(".j-receive-item","click.receiveItem").delegate(".j-receive-item","click.receiveItem",function(t){var a=i(this),n=a.closest("dd.file-item").data("position"),o=e._getElementData(n),l=[o.session_id],r=a.closest("dd.file-item");e._mMoreOptionsDropDown.hide(),r.data("hasChecked")===!0&&e.$container.find(".j-check-all").find(".u-icon-box").hasClass("u-icon-selected")===!1&&t.stopPropagation(),a.hasClass("status-receiving")===!1&&(FileUtils._mMoveSaveDialog||(FileUtils._mMoveSaveDialog=new disk.ui.MoveSaveDialog),FileUtils._mMoveSaveDialog.onConsent=function(t){r.find(".file-info").removeClass("fn-bold"),a.hasClass("status-receiving")===!1&&(a.closest("div").replaceWith(s.getStatusDom(s.RECEIVING)),e._mDatasReceive.selectedSessionIdArray=_.union(e._mDatasReceive.selectedSessionIdArray,l),i.map(e._mDatasReceive.selectedSessionIdArray,function(i,s){e._mDatasReceive.validDaysArray[s]=e._mDatasReceive.sessionToVDays[i]}),disk.DEBUG&&(console.log("[SINGLE CLICK] that._mDatasReceive.selectedSessionIdArray is "+e._mDatasReceive.selectedSessionIdArray),console.log("[SINGLE CLICK] that._mDatasReceive.validDaysArray is "+e._mDatasReceive.validDaysArray))),e.path=t||"/",e._ajaxReceive()},FileUtils._mMoveSaveDialog.setVisible(!0))}),this.$container.undelegate(".j-receive-all","click.receiveAll").delegate(".j-receive-all","click.receiveAll",function(){var s=i(this);e._mMoreOptionsDropDown.hide(),s.hasClass("u-btn-receiving")===!1&&s.hasClass("u-btn-disabled")===!1&&(FileUtils._mMoveSaveDialog||(FileUtils._mMoveSaveDialog=new disk.ui.MoveSaveDialog),FileUtils._mMoveSaveDialog.onConsent=function(t){var a=[];s.addClass("u-btn-receiving").find("b").text("保存中..."),e.$container.find("dd.file-item").each(function(){var s=i(this);if(s.find(".u-icon-box").hasClass("u-icon-selected")===!0){var t=s.data("position"),n=e._getElementData(t);s.find(".j-receive-item")[0]&&s.hasClass("status-receiving")===!1&&(s.find(".file-title").removeClass("fn-bold"),s.find(".j-receive-item").addClass("status-receiving").text("保存中..."),a.push(n.session_id))}}),e._mDatasReceive.selectedSessionIdArray=_.union(e._mDatasReceive.selectedSessionIdArray,a),i.map(e._mDatasReceive.selectedSessionIdArray,function(i,s){e._mDatasReceive.validDaysArray[s]=e._mDatasReceive.sessionToVDays[i]}),disk.DEBUG&&(console.log("[ALL RECEIVE CLICK] that._mDatasReceive.selectedSessionIdArray IS "+e._mDatasReceive.selectedSessionIdArray),console.log("[ALL RECEIVE CLICK] that._mDatasReceive.validDaysArray IS "+e._mDatasReceive.validDaysArray)),e.path=t||"/",e._ajaxReceive()},FileUtils._mMoveSaveDialog.setVisible(!0))}),this.$container.undelegate(".j-receive-all-new","click.receiveAllNew").delegate(".j-receive-all-new","click.receiveAllNew",function(){var s=i(this);e._mMoreOptionsDropDown.hide(),s.hasClass("u-btn-receiving")===!1&&s.hasClass("u-btn-disabled")===!1&&e._doTransfer()}),this.$container.undelegate(".j-delete-all","click.deleteAll").delegate(".j-delete-all","click.deleteAll",function(){var s,n=new r,o="";e.type==c.TYPE_SEND&&(o="<br />(删除发送的文件记录不会影响好友接收文件)"),n.setVisible(!0),n.setMessage("确认删除","确定删除所选文件记录吗？"+o,function(){this.setVisible(!1),t.obtain.useToast({toastMode:t.obtain.MODE_LOADING,msg:"正在删除，请稍候&hellip;",sticky:!0,position:a.TOP}),s=e._getSessionIdArray(),i.ajax({url:c.URL_DELETE,type:"GET",data:{type:e.type,session_array:i.stringify(s)},dataType:"JSON",success:function(n){if(0===n.errno){t.obtain.useToast({toastMode:t.obtain.MODE_SUCCESS,msg:"文件记录删除成功",sticky:!1,position:a.TOP,closeType:!1}),e.type===c.TYPE_RECEIVE?(i.map(s,function(i){e._mDatasReceive.sessionToDDs[i].remove()}),e._mDatasReceive.selectedSessionIdArray=_.difference(e._mDatasReceive.selectedSessionIdArray,s),0===e._mDatasReceive.selectedSessionIdArray.length&&e._stopLoop()):i.map(s,function(i){e._mDatasSend.sessionToDDs[i].remove()}),e.cnt=e.cnt-s.length;var o=[];e.$module.find("dd.file-item").each(function(){var s=i(this),t=e._mElementDatas[s.data("position")];t.session_category==l.PIC&&t.last_time>0&&(s.attr("data-pic-index",o.length),t.object_info.server_filename=t.session_title,o.push(t.object_info))}),e._mPicList=o,0===e.cnt?e.tab(e.type,!0):e._changeOption(0)}else disk.DEBUG&&console.log("AJAX "+c.URL_DELETE+" fail and the errno is "+n.errno),c.showErrorTip()},error:function(){disk.DEBUG&&console.error("AJAX "+c.URL_DELETE+" ERROR !")}})})}),this.$container.undelegate("dd.file-item","dblclick.fileItem").delegate("dd.file-item","dblclick.fileItem",function(){i(this).find(".file-title").trigger("click.fileTitle")}),this.$container.undelegate(".file-title","click.fileTitle").delegate(".file-title","click.fileTitle",function(){var t;return function(a){a.stopPropagation(),e._mMoreOptionsDropDown.hide();var o=i(this).closest("dd.file-item"),r=o.data("position"),c=e._getElementData(r);if(!(c.last_time<=0||c.joined_status===s.CHECK_ALL_FAIL))if(e._isSession===!0?(e._isSelfShare=c.founder_uk==yunData.MYUK?!0:!1,e._founderUkForFileinfoTransfer=e._isSelfShare===!0?void 0:c.founder_uk,e._sessionIdForFileinfoTransfer=c.session_id,t={founder_uk:c.founder_uk,founder_uname:c.founder_uname,create_time:c.create_time,session_id:c.session_id,last_time:c.last_time,member_title:c.member_title}):i.extend(c,t),e._isSession===!0)if(c.object_info)if(i.extend(c.object_info,t),c.object_info.server_filename=c.session_title,c.object_info.isdir)e._mDirManager.goTo(c.object_info),e._changeOption(0),n.diskLog.send({type:"module_p2p_preview",val:"folder",from:e.type});else{if(1===c.session_category)return;if(c.session_category==l.PIC)var d=o.data("pic-index");e._previewFile(c.object_info,t,d,o)}else e._mDirManager.goTo(c),e._changeOption(0);else{var h=c.category;if(h===l.OTH)e._mDirManager.goTo(c);else{if(c.category==l.PIC)var d=o.data("pic-index");e._previewFile(c,t,d,o)}}}}()),this.$container.undelegate(".view","click.view").delegate(".view","click.view",function(){var s=i(this).closest(".file-item").data("position"),t=e._getElementData(s);i.ajax({url:c.URL_GETPATH,type:"GET",data:{session_id:t.session_id},dataType:"JSON",success:function(e){0===e.errno?win.location.href="/disk/home#dir/path="+encodeURIComponent(e.path||"/"):(disk.DEBUG&&console.log("[AJAX] "+c.URL_GETPATH+" errno="+e.errno),c.showErrorTip())},error:function(){disk.DEBUG&&console.error("AJAX "+c.URL_GETPATH+" ERROR !")}})}),this.$container.undelegate(".j-user-name","contextmenu").delegate(".j-user-name","contextmenu",function(i){i.stopPropagation(),e._mMoreOptionsDropDown.hide()}),this.$container.undelegate("dd.file-item","mouseenter.fileItem").delegate("dd.file-item","mouseenter.fileItem",function(){i(this).addClass("file-item-hover")}).delegate("dd.file-item","mouseleave.fileItem",function(){i(this).removeClass("file-item-hover")})},_getFileinfoParam:function(e){var i=this;return void 0!==e.session_category&&0===e.session_category?(reqData={session_id:e.session_id,founder_uk:e.founder_uk,type:i.type,start:i.start,limit:i.limit},i.scrollAppend||i._loadingHeader()):void 0!==e.session_category&&6===e.session_category||e.category&&6===e.category?(reqData={session_id:e.session_id,founder_uk:e.founder_uk,type:i.type,start:i.start,limit:i.limit,object_id:e.object_id,fs_id:e.fs_id},i.scrollAppend||i._loadingHeader()):reqData={session_id:e.session_id,founder_uk:e.founder_uk,type:i.type,object_id:e.object_id,fs_id:e.fs_id},reqData},_setPicList:function(){var e=[],s=this;this.$module.find("dd.file-item").each(function(){var t=i(this),a=s._mElementDatas[t.data("position")];a.category==l.PIC&&(t.attr("data-pic-index",e.length),e.push(a))}),this._mPicList=e},_doFileinfoData:function(e,t,a){var n=this;0===e.errno?(e.list.length>0?(n._unbind(),i.extend(e,t),n.scrollAppend?(e.baseListNo=n._mElementDatas.length,$dom=i(s.parseList.renderFileInfoList(n.type,e)),n._mElementDatas=n._mElementDatas.concat(e.list),n.$module.find(".main-list").append($dom)):(e.baseListNo=0,n._mElementDatas=e.list,$dom=i(s.parseList.renderFileInfoList(n.type,e)),n.$module.find(".main-list").html($dom)),n._setPicList()):(n.scrollAppend||(n.$module.find(".main-list").html('<div class="empty-tip">没有文件</div>'),n.$container.find(".total").addClass("fn-hide")),n.listEnd=!0),n.$container.find(".total").html("已加载"+(n.start+e.list.length)+"条"),a&&a()):e.errno===c.ERRNO_FILE_NOT_EXISTS?(n._showFileNotExistsTips(),a&&a()):(disk.DEBUG&&console.log("AJAX "+c.URL_FILEINFO+" fail and the errno is "+e.errno),c.showErrorTip(),n._resetHeader(),n.$container.find(".total").addClass("fn-hide"),a&&a())
},_ajaxFileinfo:function(e,s){var t,a=this;if(this._isSession=!1,"undefined"==typeof e&&this.lastEntity){if(this.listEnd||this.isRequiring)return disk.DEBUG&&console.log("[LOG] this page list is arrival the end or another list is requiring"),void 0;this.start=this.$module.find(".file-item").length,e=this.lastEntity,this.scrollAppend=!0}else this.listEnd=!1,this.lastEntity=e,this.start=0,this.scrollAppend=!1;this.isRequiring=!0,t=this._getFileinfoParam(e),i.ajax({url:c.URL_FILEINFO,type:"GET",data:t,dataType:"JSON",success:function(i){a._doFileinfoData(i,e,s),a.isRequiring=!1},error:function(){disk.DEBUG&&console.log("[URL_FILEINFO] ERROR !"),a.$container.find(".total").addClass("fn-hide"),a.isRequiring=!1}})},_showFileNotExistsTips:function(){t.obtain.useToast({toastMode:t.obtain.MODE_CAUTION,msg:"文件已被删除，无法预览",sticky:!0,position:a.TOP,closeType:!0}),this.$module.find(".main-list").html('<div class="empty-tip">没有文件</div>'),this.$container.find(".total").html("已加载0条")},_previewFile:function(e,i,s){var t=this,a=e.session_category||e.category;if("string"==typeof a&&(a=parseInt(a,10)),1!==a)if(2==a){var o=[{songId:e.fs_id%65025,songName:e.server_filename,link:e.dlink}];null==t._mMboxPlayer?n.getWidgets("common:widget/musicBox/musicBox.js",function(e){t._mMboxPlayer=new e(o)}):t._mMboxPlayer.reBuild(o),n.diskLog.send({type:"module_p2p_preview",val:"music",from:t.type})}else if(3==a){n.getWidgets("common:widget/picPreview/picPreview.js",function(){mdev.message.trigger("show_picture",{index:s,list:t._mPicList,controls:{del:1,print:1,edit:1,share:1,download:1,directory:1}})}),n.diskLog.send({type:"module_p2p_preview",val:"pic",from:t.type})}else 4==a&&(null==t._mDocumentReader?n.getWidgets("common:widget/docReader/docReader.js",function(i){t._mDocumentReader=new i,t._mDocumentReader.reBuild(e)}):t._mDocumentReader.reBuild(e),n.diskLog.send({type:"module_p2p_preview",val:"doc",from:t.type}))},_unbind:function(){this._isSession===!1&&this.type===c.TYPE_SEND&&(this.$container.undelegate("dd","contextmenu"),this.$container.undelegate("dd.file-item","click.fileItem"),this.$container.find(".j-check-all").addClass("fn-vhidden"))},_ajaxMetas:function(e,s){i.ajax({url:c.URL_METAS,type:"GET",data:{session_id:e.session_id,founder_uk:e.founder_uk,type:this.type},dataType:"JSON",success:function(e){0===e.errno?"function"==typeof s&&s(e):(disk.DEBUG&&console.log("AJAX "+c.URL_METAS+" fail and the errno is "+e.errno),c.showErrorTip())},error:function(){disk.DEBUG&&console.error("AJAX "+c.URL_METAS+" ERROR !")}})},_bind:function(){var e=this;this.$container.undelegate("dd.file-item","contextmenu").delegate("dd.file-item","contextmenu",function(){var s=function(){this.init()};return s.singleton=null,s.obtain=function(){if(null===s.singleton){var e=new s;s.singleton=e}return s.singleton},s.destroy=function(){i("html>body>.u-menu").remove()},s.prototype={init:function(){this.$menuDom=null,this.bind()},bind:function(){var t=this,a=i(document);a.unbind("contextmenu").bind("contextmenu",function(){s.singleton.hide()}),a.unbind("click.menu").bind("click.menu",function(){s.singleton.hide()}),a.undelegate(".u-menu .open","click").delegate(".u-menu .open","click",function(e){e.stopPropagation(),t.$element.find(".file-title").trigger("click.fileTitle")}),a.undelegate(".u-menu .receive","click").delegate(".u-menu .receive","click",function(e){e.stopPropagation(),t.$element.find(".j-receive-item").trigger("click.receiveItem")}),a.undelegate(".u-menu .receive-new","click").delegate(".u-menu .receive-new","click",function(i){i.stopPropagation(),e.$module.find(".j-receive-all-new").trigger("click.receiveAllNew")}),a.undelegate(".u-menu .delete","click").delegate(".u-menu .delete","click",function(i){i.stopPropagation(),e.$module.find(".j-delete-all").trigger("click.deleteAll")})},show:function(e){s.destroy(),this.$element=e.$element,this.hasReceive=e.hasReceive,this.hasLink=e.hasLink,this.isSession=e.isSession,this.isSelfShare=e.isSelfShare,this.isReceiveType=e.isReceiveType,this.isOverDate=e.isOverDate,this.parseHtml(e.pageX,e.pageY)},hide:function(){this.$menuDom&&(this.$menuDom.remove(),this.$menuDom=null)},parseHtml:function(e,s){var t,a=this,n=function(){return a.isReceiveType===!0?a.isSelfShare===!0||a.isOverDate===!0?"":a.isSession===!0?'<li class="normal"><a class="item receive" href="javascript:;">保存</a></li>':'<li class="normal"><a class="item receive-new" href="javascript:;">保存</a></li>':""};if(t=this.hasReceive===!0?this.hasLink===!0?i('<ul class="u-menu"><li class="normal"><a class="item open" href="javascript:;">打开</a></li>'+n()+'<li class="end"><a class="item delete" href="javascript:;">删除</a></li></ul>'):i('<ul class="u-menu">'+n()+'<li class="end"><a class="item delete" href="javascript:;">删除</a></li></ul>'):this.hasLink===!0?i('<ul class="u-menu"><li class="normal"><a class="item open" href="javascript:;">打开</a></li>'+n()+'<li class="end"><a class="item delete" href="javascript:;">删除</a></li></ul>'):i('<ul class="u-menu">'+n()+'<li class="end"><a class="item delete" href="javascript:;">删除</a></li></ul>'),this.isSession===!1){if(t.find("li.end").remove(),!t.find("li").last()[0])return;t.find("li").last().addClass("end")}t.css({left:e,top:s}).appendTo(i("html>body")),this.$menuDom=t,this.bindContextmenu()},bindContextmenu:function(){this.$menuDom.unbind("contextmenu").bind("contextmenu",function(e){e.preventDefault(),e.stopPropagation()})}},e._mMoreOptionsDropDown=s.obtain(),function(s){s.preventDefault(),s.stopPropagation();var t=i(this),a=t.data("position"),n=e._getElementData(a),o=!1,l=!1,r=!1;(t.data("hasChecked")===!1||void 0===t.data("hasChecked"))&&t.trigger("click.fileItem"),t.find(".j-receive-item")[0]&&t.find(".j-receive-item").hasClass("status-receiving")===!1&&n.last_time>=0&&(o=!0),t.find("a.file-title")[0]&&(l=!0),e._isSession===!0&&(e._isSelfShare=n.founder_uk==yunData.MYUK?!0:!1),e._isSession===!0&&n.last_time<=0&&(r=!0),e._mMoreOptionsDropDown.show({isReceiveType:e.type===c.TYPE_RECEIVE?!0:!1,hasReceive:o,hasLink:l,isSession:e._isSession,isSelfShare:e._isSelfShare,isOverDate:r,$element:t,pageX:s.pageX,pageY:s.pageY})}}()),this.$container.undelegate("a.j-sharetime","click.j-sharetime").delegate("a.j-sharetime","click.j-sharetime",function(){var t=i(this);if(e._isSession){t.hasClass("g-col-time-down")?t.removeClass("g-col-time-down").addClass("g-col-time-up"):t.removeClass("g-col-time-up").addClass("g-col-time-down");var a=[],n=[];e.$container.find("dd.file-item").each(function(){n.push(e._mElementDatas[i(this).data("position")])});for(var o=n.length,l=o-1;l>=0;l--)a.push(n[l]);e._mElementDatas=a;var r=s.parseList.renderSessionList(e.type,{list:a});e.$module.find(".main-list").html(r)}}),this.$container.undelegate("dd.file-item","click.fileItem").delegate("dd.file-item","click.fileItem",function(){var s=i(this);if(e.$container.find(".j-check-all .u-icon-box").hasClass("u-icon-selected")===!0&&e.$container.find(".j-check-all").trigger("click.checkAll"),s.data("hasChecked")===!0)s.removeClass("file-item-selected"),s.find(".u-icon-box").removeClass("u-icon-selected"),e.type===c.TYPE_SEND?s.find(".metas-box").addClass("fn-hide"):s.find(".description-txt").addClass("fn-ellipsis"),s.data("hasChecked",!1),e._changeOption(0);else{var t=s.siblings("dd.file-item"),a=s.data("position"),n=e._getElementData(a);t.removeClass("file-item-selected").data("hasChecked",!1).find(".description-txt").addClass("fn-ellipsis"),t.find(".u-icon-box").removeClass("u-icon-selected"),s.addClass("file-item-selected"),s.find(".u-icon-box").addClass("u-icon-selected");var o=s.find(".metas-box");if(e.type===c.TYPE_SEND)t.find(".metas-box").addClass("fn-hide"),o.removeClass("fn-hide").find(".receivers").removeClass("fn-hide"),(o.data("hasData")===!1||void 0===o.data("hasData"))&&e._ajaxMetas(n,function(e){for(var i=[],s=0;s<e.member_list.length;s++)i.push(e.member_list[s].member_uname);o.data("hasData",!0).find(".receivers").removeClass("fn-hide").find("span").html(i.join("、")),e.session_desc.length>0&&o.find(".description").removeClass("fn-hide").find("span").text(e.session_desc)});else{var l=o;(o.data("hasData")===!1||void 0===o.data("hasData"))&&l.find(".description-txt").removeClass("fn-ellipsis")}s.data("hasChecked",!0),e._changeOption(1)}})}};mdev.message.listen("inbox-manage-tab",function(e){try{if(void 0===i){var i=new c({type:e.type});i.tab(e.type,e.userType)}else i.tab(e.type,e.userType)}catch(s){throw new Error(s.message)}})});
;define("clouddisk-ui:widget/list-toolbar/list-toolbar.js",function(e){var t={mod:"div.module-list-toolbar",num:'span[node-type="num"]',chk:'span[node-type="chk"]',btnDevice:'span[node-type~="btn-device"]',btnMore:'span[node-type~="btn-more"]',deviceList:'div[node-type~="device-list"]',addDevice:'a[node-type~="device-add"]',pushDevice:'a[node-type~="device-item"]',btnOperate:'a[node-type~="btn-operate"], span[node-type~="btn-operate"]'},i=e("common:widget/data-center/data-center.js"),d=e("common:widget/libs/jquerypacket.js"),n=e("common:widget/commonService/commonService.js"),s=d(t.mod),a={},c=function(){s.delegate(t.chk,"click",function(){var e=s.find(t.chk);e.hasClass("chked")?mdev.message.trigger("selected-all",!1):mdev.message.trigger("selected-all",!0)}),s.delegate(t.pushDevice,"click",function(e){e.stopPropagation();var t=d(e.target),n=t.data("device").split("|"),s=n[0],a=n[1];a&&"device-outline"===a?Toast.obtain.useToast({toastMode:Toast.obtain.MODE_CAUTION,msg:"设备处于离线状态，不可推送，请检查设备",sticky:!1}):(i.set("current-push-device",s),mdev.message.trigger("file-operate","push-file"))}),s.delegate(t.btnOperate,"click",function(e){var i=d(e.target).closest(t.btnOperate);if(!i.hasClass("disable")){var n=i.data("key");"push"!==n&&mdev.message.trigger("file-operate",n)}}),s.delegate(t.btnDevice,"mouseenter",function(){l()}),s.delegate(t.addDevice,"click",function(){n.getWidgets("common:widget/deviceAddEquipment/deviceAddEquipment.js",function(e){a.deviceAddEquipment=a.deviceAddEquipment||new e,a.deviceAddEquipment.show()})}),i.get("isIE6")&&(s.delegate(t.btnMore,"mouseover",function(e){d(e.target).closest(t.btnMore).find("div").show()}),s.delegate(t.btnMore,"mouseout",function(e){d(e.target).closest(t.btnMore).find("div").hide()}),s.delegate(t.btnDevice,"mouseover",function(e){d(e.target).closest(t.btnDevice).find("div").show()}),s.delegate(t.btnDevice,"mouseout",function(e){d(e.target).closest(t.btnDevice).find("div").hide()}))},o=function(e){var i,d,n,a=s.find(t.btnOperate);for(d=0;d<a.length;d++)i=a.eq(d),n=i.data("key"),i.hide(),"enable"===e[n]&&(i.show().removeClass("disable"),i.children("span.ico").removeClass("icon-disable")),"disable"===e[n]&&("puzzle"===n|"prettify"===n|"print"===n|"history"===n?i.hide():(i.show().addClass("disable"),i.children("span.ico").addClass("icon-disable")))},l=function(){var i=e("common:widget/api-center/api-center.js");s.find(t.deviceList).html('<div class="global-center"><span>正在加载设备...</span></div>'),i.getDeviceListAsyc({},function(e){for(var i=[],d=e.device_list,n=0,a=0;a<d.length;a++){var c=d[a].is_online?"device-online":"device-outline";0!=d[a].has_access_token&&0!=d[a].status&&d[a].is_online&&"1"==d[a].device_capacity[0]&&(n++,i.push('<a node-type="device-item" class="device-type" data-device="'+d[a].device_id+"|"+c+'" href="javascript:;"><em class="'+c+'"></em>'+d[a].device_desc+"</a>"))}0==n&&(i.push('<a class="disabled" href="javascript:;">无在线设备</a>'),i.push('<a class="device-add" node-type="device-add" href="javascript:;">添加设备</a>')),s.find(t.deviceList).html(i.join(""))})},r=function(){c(),mdev.message.listen("list-toolbar-render",function(e,i,d){0>=e?s.hide():(s.show(),s.find(t.num).html(e),i?s.find(t.chk).addClass("chked"):s.find(t.chk).removeClass("chked"),o(d))})};r()});
;define("clouddisk-ui:widget/list-view-empty/list-view-empty.js",function(e,o,t){var n=e("common:widget/libs/jquerypacket.js"),i={module:"div.module-list-view-empty",noResultTcode:'a[node-type~="no-result-twocode-btn"]',noResultTcodePic:'div[node-type~="no-result-twocode-pic"]',noResultTcodeClose:'a[node-type~="no-result-twocode-close"]',newDirBox:'input[node-type~="new-dir-box"]',newDir:'div[node-type~="new-dir"]'},d=function(){d.init()};d.init=function(){mdev.message.listen("render-list-empty",function(e){e?n(i.module).show():n(i.module).hide(),d.bindEvent()})},d.bindEvent=function(){var e=!1,o=null,t=n(i.module);t.delegate(i.noResultTcode,"mouseover",function(){n(i.noResultTcodePic).show()}),t.delegate(i.noResultTcodePic,"mouseover",function(){e=!0}),t.delegate(i.noResultTcodePic,"mouseleave",function(){n(i.noResultTcodePic).hide()}),t.delegate(i.noResultTcode,"mouseout",function(){o=setTimeout(function(){e||(n(i.noResultTcodePic).hide(),e=!1)},200)}),t.delegate(i.noResultTcodeClose,"click",function(){n(i.noResultTcodePic).hide()})},t.exports=new d});
;define("clouddisk-ui:widget/list-view/inbox-manage.js",function(e){e("common:widget/libs/jquerypacket.js"),e("common:widget/commonService/commonService.js")});
;define("clouddisk-ui:widget/list-view/recyclebin.js",function(e,t,i){var l=e("common:widget/commonService/commonService.js"),s=e("common:widget/data-center/data-center.js"),c=function(e){if(r.list.cash){for(var t,i=0;i<r.list.cash.length&&(t=r.list.cash[i],t.fs_id.toString()!==e.toString());i++);return t}},n=function(e){var t=0,i=[];for(t;t<e.length;t++)i.push(c(e[t]));return i},r={};r.widget={},r.list={cash:{},params:{num:100,page:1},cxt:{},renderCallback:null,lastPage:-1,isMore:!0},s.get("isIE6")&&(r.list.params.num=30),r.list.cxt={mListView:{width:{name:"50%",cols:["15%","20%","13%"]},title:{name:"文件名",cols:["大小","删除时间","有效时间"]},titleKey:{name:"server_filename",cols:["size","time","server_ctime"]},list:[]}},r.list.formatData=function(e){var t,i,s,c={list:e},n=[];for(t=0;t<c.list.length;t++)i=c.list[t],s=l.getFileExtName(i.path,i.isdir),n.push({id:i.fs_id,name:i.server_filename,extName:s,btns:["restore","delete"],cols:[i.size?l.toFriendlyFileSize(i.size):"-",l.parseDate(i.server_mtime),l.dateDiff(1e3*i.server_mtime,yunData.SERVERTIME||(new Date).getTime())]});return n},r.list.sortData=function(e,t){var i=[],l=r.list.cash;return i=l.sort(function(i,l){"time"===e&&(e="server_mtime");var s=i[e]>l[e];return t&&(s=i[e]<l[e]),s?1:-1})};var a={orderKey:"time",isDesc:!0,loading:function(){},setListRenderHandler:function(e){"function"==typeof e&&(r.list.renderCallback=e)},renderTitle:function(e){e(r.list.cxt)},render:function(){var t=this,i=r.list.params,l=r.list.cxt;if(i.page===r.list.lastPage)return l.mListView.list=r.list.formatData(r.list.sortData(t.orderKey,t.isDesc)),"function"==typeof callback&&(r.list.renderCallback=callback,callback(l,!1)),void 0;i.order=t.orderKey,t.isDesc?i.desc=1:delete i.desc;var s=e("common:widget/api-center/api-center.js");s.getRecycleListAsync(i,function(e){if(!e.list.length&&i.page>1)return r.list.isMore=!1,void 0;var t=!1;1!==i.page&&(t=!0),r.list.cash=t?r.list.cash.concat(e.list):e.list,mdev.message.trigger("render-crumbs-count",r.list.cash.length),l.mListView.list=r.list.formatData(e.list),r.list.lastPage=i.page,r.list.renderCallback(l,t)})},loadMore:function(){r.list.isMore&&(r.list.params.page++,this.render(r.list.renderCallback))},restore:function(e,t){var i=n(e);l.getWidgets("common:widget/fileReduction/fileReduction.js",function(e){r.widget.fileReduction=r.widget.fileReduction||new e,r.widget.fileReduction.build(i,function(){r.list.lastPage=-1,t()})})},clearAll:function(){l.getWidgets("common:widget/fileDeleteRecycle/fileDeleteRecycle.js",function(e){r.widget.fileDeleteRecycle=r.widget.fileDeleteRecycle||new e,r.widget.fileDeleteRecycle.build({list:"",clearAll:!0,succCallback:function(){r.list.lastPage=-1,a.render(r.list.renderCallback)}})})},del:function(e,t){var i=n(e);l.getWidgets("common:widget/fileDeleteRecycle/fileDeleteRecycle.js",function(e){r.widget.fileDeleteRecycle=r.widget.fileDeleteRecycle||new e,r.widget.fileDeleteRecycle.build({list:i,clearAll:!1,succCallback:function(){r.list.lastPage=-1,t()}})})}};window.setTimeout(function(){a.render()},0),i.exports=a});
;define("clouddisk-ui:widget/list-view/share-manage.js",function(t,e,i){var n,r=t("common:widget/commonService/commonService.js"),a=(t("common:widget/ZeroClipboard/ZeroClipboard.js"),t("common:widget/copy/copy.js")),s={},o={},l={page:1},c=-1,m=!0,d={mListView:{width:{name:"50%",cols:["20%","9%","9%","9%"]},title:{name:"分享文件",cols:["分享时间","浏览次数","保存次数","下载次数"]},titleKey:{name:"name",cols:["ctime","vCnt","tCnt","dCnt"]},list:[]}},p={};p.list={},p.list.formatData=function(t){var e,i,n={list:t},a=[];for(e=0;e<n.list.length;e++){i=n.list[e],nitem={},nitem.id=i.shareId,nitem.name=i.typicalPath.split("/").pop(),nitem.status=i.status,nitem.shortlink=i.shortlink,nitem.public=i.public,nitem.passwd=i.passwd,nitem.openEnabled=!0,nitem.tag=i.tag,nitem.cols=[r.parseDate(i.ctime),i.vCnt+"次",i.tCnt+"次",i.dCnt+"次"];var s=!1,o=!1;-1===i.typicalCategory?s=!0:i.fsIds.length>1&&(nitem.name=nitem.name+"等",o=!0),nitem.extName=r.getFileExtName(i.typicalPath,s,o),"分享的文件已被删除"===nitem.name&&(nitem.greycolor=!0),nitem.btns=["unshare"],nitem.copyBar=!0,a.push(nitem)}return a},p.list.sortData=function(t,e){var i=[],n=o;return i=n.sort(function(i,n){var r=i[t]>n[t];return e&&(r=i[t]<n[t]),"name"===t&&(r=i.typicalPath.split("/").pop()<n.typicalPath.split("/").pop(),e&&(r=i.typicalPath.split("/").pop()>n.typicalPath.split("/").pop())),r?1:-1})};var g={orderKey:"ctime",isDesc:!0,setListRenderHandler:function(t){"function"==typeof t&&(p.list.renderCallback=t)},sort:function(t,e){l.page=1,this.orderKey=t,this.isDesc=e,this.render(n)},getItemById:function(t){if(o){for(var e,i=0;i<o.length&&(e=o[i],e.shareId.toString()!==t.toString());i++);return e}},getItemArray:function(t){var e=0;for(getItem=[],e;e<t.length;e++)getItem.push(this.getItemById(t[e]));return getItem},renderTitle:function(t){t(d)},render:function(){var e=this,i=t("common:widget/api-center/api-center.js");if(l.page===c)return d.mListView.list=p.list.formatData(p.list.sortData(e.orderKey,e.isDesc)),p.list.renderCallback(d,!1),void 0;var n=!1;1!==l.page&&(n=!0),l.order=this.orderKey,this.isDesc?l.desc=1:delete l.desc,d.mListView.list=[],i.getShareRecordAsync(l,function(t){if(!t.list.length&&l.page>1)return m=!1,void 0;o=n?o.concat(t.list):t.list,mdev.message.trigger("render-crumbs-count",o.length),d.mListView.list=p.list.formatData(t.list),c=l.page,p.list.renderCallback(d,n)})},loadMore:function(){m&&(l.page++,this.render(n))},unshare:function(t){var e=this.getItemArray(t);r.getWidgets("common:widget/fileCancleShare/fileCancleShare.js",function(t){s.fileCancleShare=s.fileCancleShare||t,s.fileCancleShare(e,function(){c=-1,g.render(n)})})},copyShareUrl:function(t,e){var i=this.getItemById(t);a.installCopyLink(i,e)},nameClick:function(t){var e=this.getItemById(t);window.open(e.shortlink,"_blank")}};window.setTimeout(function(){g.render()},0),i.exports=g});
;define("clouddisk-ui:widget/list-view/list-view.js",function(e){var t={mod:"div.module-list-view",wrapper:'div[node-type~="wrapper"]',tmplTitle:'textarea[node-type~="tmpl-title"]',tmplList:'textarea[node-type~="tmpl-list"]',item:'div[node-type~="item"]',itemChk:'span[node-type~="chk"]',itemChkAll:'span[node-type~="chk-all"]',copyBar:'div[node-type~="copy-bar"]',titleCol:'div[node-type~="title-col"]',orderStatus:'span[node-type~="order-status"]',name:'div[node-type~="name"]',nameText:'span[node-type~="name-text"]',title:'div[node-type~="title"]',list:'div[node-type~="list"]',searchDir:'span[node-type~="search-feild"]',itemBtn:'a[node-type~="btn-item"]',itemRenameBtn:'a[node-type~="btn-rename"]',moreBtn:'span[node-type~="btn-more"]',moreList:'div[node-type~="more-list"]',loading:'div[node-type~="loading"]',editName:'div[node-type~="edit-name"]',editNameBox:'input[node-type~="edit-name-box"]',editNameSure:'span[node-type~="edit-name-sure"]',editNameCancel:'span[node-type~="edit-name-cancel"]',newDir:'div[node-type~="new-dir"]',newDirBox:'input[node-type~="new-dir-box"]',newDirSure:'span[node-type~="new-dir-sure"]',newDirCancel:'span[node-type~="new-dir-cancel"]'},i={},n={},a=!1,s=e("common:widget/commonService/commonService.js"),o=e("common:widget/data-center/data-center.js"),l=e("common:widget/scrollUtils/scrollUtils.js"),d=e("common:widget/libs/jquerypacket.js"),r=e("common:widget/hash/hash.js"),c=d(t.mod),m=e("common:widget/shortcut/keyboard.js"),p=function(){c.find(t.newDir).prependTo(c.find(t.list)),c.find(t.newDir).show().find(t.newDirBox).val("新建文件夹").select(),c.find(t.list).scrollTop(0),"none"===c.css("display")&&c.show()},f=function(){c.find(t.newDir).appendTo(c.find(t.title)),c.find(t.newDir).hide(),0===c.find(t.list).find(t.item).length&&c.hide()},h=function(){k.calSelected(function(){var e=o.get("selectedItemList");e.forEach(function(e){e.remove(),k.onDelete(e)}),k.calSelected()})},g=function(){for(var e,n=c.find(t.titleCol),a=0;a<n.length;a++)e=n.eq(a),e.find(t.orderStatus).css("visibility","hidden"),e.data("key")===i.orderKey&&(e.find(t.orderStatus).css("visibility","visible"),i.isDesc||e.find(t.orderStatus).removeClass("desc"));y()},u=function(e,i){if(!a){if(!i){if(c.find(t.list).scrollTop(0),!e.mListView.list.length)return c.hide(),k.saveItems([]),k.calSelected(),mdev.message.trigger("render-list-empty",!0),mdev.message.trigger("render-share-empty",!0),void 0;c.show(),mdev.message.trigger("render-list-empty",!1),mdev.message.trigger("render-share-empty",!1)}var n,s=c.find(t.tmplList).val();i?(n=d(mdev.tmpl(s,e)),c.find(t.list).append(n),k.saveItems(n.filter(t.item),!0)):(c.find(t.list).html(mdev.tmpl(s,e)),k.saveItems(c.find(t.list).find(t.item))),g(),y();var r=o.get("selectedList");k.selectList(r),o.get("isOnlyRenderTypeChange")||k.calSelected(),l.resolveHasScroll(c.find(t.list))?c.find(t.title).css("padding-right",l.getScrollBarWidth()):c.find(t.title).css("padding-right",0)}},v=function(e){var i=e.closest(t.item),n=i.find(t.name),a=i.find(t.nameText),s=i.find(t.editName),o=i.find(t.editNameBox);n.hide(),s.show(),o.val(a.html()).select()},y=function(){var e=c.find(t.list);if(e.length){var i=e.offset().top,n=d(window).height();e.height(n-i).css("overflow","auto")}},k=function(){var a=[],s=!1,l=function(e,i){var n=e.closest(t.item);i?(e.addClass("chked"),n.addClass("item-active")):(e.removeClass("chked"),n.removeClass("item-active"))},d=function(e){var i,n;for(i=0;i<a.length;i++)n=a[i].find(t.itemChk),e&&!n.hasClass("chked")&&l(n,!0),!e&&n.hasClass("chked")&&l(n,!1);s=e?!0:!1},r=function(){d(!0)},m=function(){d(!1)},p=e("common:widget/hash/hash.js"),f=o.get("page");n={};var h,g=function(s){window.clearTimeout(h),h=window.setTimeout(function(){var l,d,r,c=e("common:widget/commonService/commonService.js"),m=0,h=!0,g=!1,u=[],v=[];for(r=0;r<a.length;r++)l=a[r].find(t.itemChk),d=l.closest(t.item),"share-manage"===f&&d.find(t.copyBar).hide(),l.hasClass("chked")&&(m++,u.push(d.attr("data-id")),v.push(d),"share-manage"===f&&s===d.index()&&(d.find('span[node-type="name-tip"]')[0]||d.find(t.copyBar).show().attr("id","copyBar"),i.copyShareUrl(d.attr("data-id"),d.find(".btn-copy"))),3!==d.data("category")&&(h=!1),c.isSpecialFile(d.data("extname"))&&(g=!0));o.set("selectedList",u),o.set("selectedItemList",v),"recyclebin"===f&&(n.restore="enable",n["delete-completely"]="enable"),"share-manage"===f&&(n.unshare="enable"),"disk-home"===f&&(n.share="enable",n.download="enable",n["delete"]="enable",n.push="enable",n.more="enable",n.move="enable",n.copy="enable",n.history="disable",n.rename="disable",n.print="disable",n.prettify="disable",n.puzzle="disable","3"===p.get("category/type")?n.music="enable":delete n.music),"disk-home"===f&&(1===m?(n.rename="enable",v[0].find(t.nameText).hasClass("enabled")?n.open="enable":delete n.open):delete n.open,1===m&&4===v[0].data("category")&&(n.history="enable"),1===m&&["dir","shouchang","yingyong","yingyong_child","beifen"].indexOf(v[0].data("extname"))<0&&(p.get("category/type")&&""!==p.get("category/type")||p.get("key")&&""!==p.get("key"))&&(!p.get("path")||""===p.get("path"))?n["folder-open"]="enable":delete n["folder-open"],h&&(n.print="enable"),1===m&&h&&(n.prettify="enable",n.puzzle="disable"),m>1&&h&&(n.puzzle="enable",n.prettify="disable"),g&&(n["delete"]="disable",n.rename="disable",n.move="disable")),mdev.message.trigger("list-toolbar-render",m,m===a.length,n),k.isMulti=m>=2?!0:!1,"function"==typeof s&&s()},0)},u=e("common:widget/shortcut/mouse-selection.js"),v=new u(c.find(t.list)),h=null,y=+[1]?0:50;v.onSelect=function(e){window.clearTimeout(h),h=window.setTimeout(function(){var i,n,s,o;for(i=0;i<a.length;i++)o=a[i].find(t.itemChk),n=a[i].offset(),s=a[i].outerHeight(),n.top<e.top&&n.top+s>e.top||n.top>e.top&&n.top+s<e.top+e.height||n.top<e.top+e.height&&n.top+s>e.top+e.height?l(o,!0):l(o,!1);g()},y)};var k={isMulti:!1,select:l,selectAll:r,selectedList:[],selectedItemList:[],unSelectAll:m,calSelected:g,isChked:function(e){return e.hasClass("chked")},saveItems:function(e,t){t||(a=[]);var i;for(i=0;i<e.length;i++)a.push(e.eq(i));s&&t&&r(!0)},onDelete:function(e){var t;for(t=0;t<a.length;t++)if(a[t].data("id")===e.data("id")){a.splice(t,1);break}0===a.length&&i.render()},shiftSelect:function(e){var i,n,s,o;for(o=0;o<a.length;o++)a[o].data("id")!==e.data("id")?a[o].find(t.itemChk).hasClass("chked")&&("undefined"==typeof i&&(i=o),n=o):s=o;for(i||(i=s,n=s),s>i?n=s:i=s,m(),o=i;n>=o;o++)l(a[o].find(t.itemChk),!0)},normalSelect:function(e){var i=e.find(t.itemChk),n=o.get("selectedList");0===n.length?l(i,!0):1===n.length&&i.hasClass("chked")?l(i,!1):(this.unSelectAll(),l(i,!0))},selectList:function(e){if(e&&e.length){var i,n,o;for(i=0;i<a.length;i++)for(o=a[i].data("id"),n=0;n<e.length;n++)o.toString()===e[n].toString()&&this.select(a[i].find(t.itemChk),!0);e.length===a.length&&(s=!0)}}};return k}(),w=function(){var e,a;c.delegate(t.item,"mouseenter",function(){k.isMulti||(a&&(a.removeClass("item-hover"),a=null),a=d(this).closest(t.item),d(this).closest(t.item).addClass("item-hover"))}),c.delegate(t.item,"mouseleave",function(e){d(e.target).closest(t.item).removeClass("item-hover"),d(e.target).closest(t.item).find(t.moreList).hide()}),c.delegate(t.itemChkAll,"click",function(e){e.stopPropagation(),k.selectAll(),k.calSelected()}),c.delegate(t.itemChk,"click",function(e){e.stopPropagation();var i=d(e.target).closest(t.item),n=i.find(t.itemChk);k.isChked(n)?k.select(n,!1):k.select(n,!0),k.calSelected()}),c.delegate(t.item,"click",function(e){var i=d(e.target);if(i.closest(t.editName).length>0)return e.stopPropagation(),void 0;var n=i.closest(t.item),a=n.find(t.itemChk);m.isShift?k.shiftSelect(n):m.isCtrl?k.isChked(a)?k.select(a,!1):k.select(a,!0):k.normalSelect(n),k.calSelected(n.index())}),c.delegate(t.item,"dblclick",function(e){if(!m.isShift&&!m.isCtrl){var i=d(e.target);if(i.closest(t.editName).length>0)return e.stopPropagation(),void 0;var n=d(e.target).closest(t.item);n.find(t.nameText).trigger("click")}}),c.delegate(t.titleCol,"click",function(e){var n=d(e.target).closest(t.titleCol),a=n.find(t.orderStatus);a.toggleClass("desc");var s,o=n.data("key");s=a.hasClass("desc")?!0:!1,i.sort?i.sort(o,s):(i.orderKey=o,i.isDesc=s,i.render())}),c.delegate(t.nameText,"click",function(e){if(i.nameClick){var n=d(e.target);if(n.hasClass("enabled")){e.stopPropagation();var a=n.closest(t.item).attr("data-id");i.nameClick(a)}}}),c.delegate(t.moreBtn,"click",function(e){e.stopPropagation();var i=d(e.target).closest(t.item).find(t.moreList);i.toggle(),window.setTimeout(function(){i.offset().top>d(window).height()-i.outerHeight()?i.addClass("more-list-up"):i.removeClass("more-list-up")},0)}),c.delegate(t.itemBtn,"click",function(e){var n=d(e.target).closest(t.itemBtn),a=n.closest(t.item),s=a.find(t.itemChk);s.hasClass("chked")&&e.stopPropagation();var o=a.attr("data-id"),l=n.data("key");switch(l){case"delete":i.del([o],h);break;case"restore":i.restore([o],h);break;case"share":i.share([o]);break;case"unshare":i.unshare([o]);break;case"download":i.download([o]);break;case"move":i.move([o],h);break;case"copy":i.copy([o]);break;case"copy-url":}}),c.delegate(t.itemRenameBtn,"click",function(e){e.stopPropagation(),v(d(e.target))}),c.delegate(t.editNameBox,"keyup",function(e){var i=d(e.target);13===e.keyCode&&i.closest(t.item).find(t.editNameSure).trigger("click")}),c.find(t.list).delegate(t.editName,"mousedown",function(e){e.stopPropagation()}),c.find(t.list).delegate(t.newDir,"mousedown",function(e){e.stopPropagation()}),c.delegate(t.editNameSure,"click",function(e){e.stopPropagation();var n=d(e.target).closest(t.item),a=n.find(t.name),s=n.find(t.editName),o=n.find(t.editNameBox),l=n.attr("data-id"),r=d.trim(o.val());return r===a.find(t.nameText).html().trim()?(s.hide(),a.show(),void 0):(i.rename(l,r,function(){a.find(t.nameText).html(r),s.hide(),a.show()}),void 0)}),c.delegate(t.editNameCancel,"click",function(e){e.stopPropagation();var i=d(e.target).closest(t.item),n=i.find(t.name),a=i.find(t.editName);n.show(),a.hide()}),c.delegate(t.newDirSure,"click",function(e){e.stopPropagation();var n=d(e.target).closest(t.newDir),a=n.find(t.newDirBox),l=o.get("currentDir");i.newDir(l+"/"+d.trim(a.val()),function(e){f();var n;c.find(t.item).length>0?(n=c.find('div[node-type="item-copy"]').clone(!0),n.attr("data-id",e.fs_id).attr("node-type","item").find('span[node-type="name-text"]').html(e.name.split("/").pop()),n.find(".col").last().html(s.parseDate(e.ctime)),n.show(),c.find(t.item).eq(0).before(n),k.saveItems(n,!0)):i.render()})}),c.delegate(t.newDirBox,"keyup",function(e){13===e.keyCode&&c.find(t.newDirSure).trigger("click")}),c.delegate(t.newDirCancel,"click",function(e){e.stopPropagation(),f()}),c.delegate(t.searchDir,"click",function(e){e.stopPropagation(),r.set("path",d(e.target).data("path"))});var l,e,p=c.find(t.list);p.bind("scroll",function(){var t=this;window.clearTimeout(e),e=window.setTimeout(function(){var e=p.scrollTop(),n=p.height();l=t.scrollHeight,n+e>l-200&&i.loadMore()},100)});var g=null;c.find(t.list).delegate(t.item,"contextmenu",function(e){clearTimeout(g);var i,a,s=d(e.target);return s.closest(t.mod).length&&!s.closest(t.editName).length?(i=s.closest(t.item),a=i.find(t.itemChk),a.hasClass("chked")||(k.unSelectAll(),a.addClass("chked"),i.addClass("item-active")),k.calSelected(),g=setTimeout(function(){mdev.message.trigger("context-menu-render",e,n)},0),!1):void 0}),d(window).bind("resize",y),c.bind("selectstart",function(){return!1}),c.delegate(t.editName,"selectstart",function(e){e.stopPropagation()}),c.delegate(t.newDir,"selectstart",function(e){e.stopPropagation()})},b=function(){var n=o.get("page");"disk-home"===n&&(i=e("clouddisk-ui:widget/list-view/disk-home.js")),"recyclebin"===n&&(i=e("clouddisk-ui:widget/list-view/recyclebin.js")),"share-manage"===n&&(d(t.mod).find('div[node-type="list"]').addClass("list-share"),i=e("clouddisk-ui:widget/list-view/share-manage.js")),"share-manage"!==n&&c.find(t.wrapper).addClass("list-view-home")},C=c.find(t.loading),S=function(){var e=r.get("render-type");if("grid-view"===e)return c.hide(),a=!0,void 0;c.find(t.list).html(""),c.show(),a=!1;var n=c.find(t.tmplTitle).val();i.renderTitle(function(e){c.find(t.title).html(mdev.tmpl(n,e))});var s=function(e){e?(c.find(t.list).html("").append(C),C.show()):C.appendTo(c).hide()};i.loading&&(i.loading=s),i.setListRenderHandler(u)},x=function(){mdev.message.listen("selected-all",function(e){a||(e?k.selectAll():k.unSelectAll(),k.calSelected())}),mdev.message.listen("file-operate",function(e){if(!a){var n=o.get("selectedList"),s=o.get("selectedItemList");switch(e){case"restore":i.restore(n,h);break;case"share":i.share(n);break;case"unshare":i.unshare(n);break;case"delete":case"delete-completely":i.del(n,h);break;case"clear-all":i.clearAll();break;case"download":i.download(n);break;case"print":i.print(n);break;case"history":i.history(n);break;case"rename":s[0].find(t.itemRenameBtn).trigger("click");break;case"copy":i.copy(n);break;case"move":i.move(n,h);break;case"music":i.musicPlayAll(n);break;case"puzzle":case"prettify":i.meitu(n);break;case"new-dir":p();break;case"push-file":i.push(n);break;case"open":i.nameClick(n[0]);break;case"folder-open":i.folderOpen(n[0])}}}),mdev.message.listen("delete_picture",function(){h()})},D=function(){w(),b(),x(),r.listen("render-type",S),S()};D()});
;define("clouddisk-ui:widget/recyclebin-empty/recyclebin-empty.js",function(e){var i=e("common:widget/libs/jquerypacket.js"),d={mod:"div.module-recyclebin-empty"},c=i(d.mod);mdev.message.listen("render-list-empty",function(e){e?c.show():c.hide()})});
;define("clouddisk-ui:widget/recyclebin-toolbar/recyclebin-toolbar.js",function(e){var c={mod:"div.module-recyclebin-toolbar",clearBtn:'span[node-type="btn-clear"]'},l=e("common:widget/libs/jquerypacket.js"),n=l(c.mod),o=function(){n.delegate(c.clearBtn,"click",function(){mdev.message.trigger("file-operate","clear-all")})},i=function(){o()};i()});
;define("clouddisk-ui:widget/share-empty/share-empty.js",function(e,d,s){var i=function(){var e={module:"div.module-share-empty"};mdev.message.listen("render-share-empty",function(d){d?$(e.module).show():$(e.module).hide()})};s.exports=new i});
;define("clouddisk-ui:widget/share-manage-header/share-manage-header.js",function(e){var a=e("common:widget/libs/jquerypacket.js"),t=e("common:widget/hash/hash.js"),n=(e("common:widget/commonService/commonService.js"),e("common:widget/restApi/restApi.js"),e("clouddisk-ui:widget/inbox-manage/inbox-manage.js"),window),s={mod:"div.module-share-manage-header",tab:'li[node-type~="tabs-item"]'},i=a(s.mod),o={_init:function(){this.listenHash(),this.addMessage(),this.initHash(),this.addEvent()},addMessage:function(){var e=this;mdev.message.listen("render-by-tabtype",function(a){switch(a=a||"share",e.handleTabChange(a),a){case"email":mdev.message.trigger("inbox-manage-tab",{type:0,userType:1}),disk.DEBUG&&console.log("%c[mdev.message]render-by-tabtype","background-color: blue; color: white;");break;case"phone":mdev.message.trigger("inbox-manage-tab",{type:0,userType:2}),disk.DEBUG&&console.log("%c[mdev.message]render-by-tabtype","background-color: blue; color: white;")}})},initHash:function(){try{var e=t.get("tabtype");void 0===e&&"email"!==e&&"phone"!==e&&(e="share"),mdev.message.trigger("render-by-tabtype",e)}catch(a){throw new Error(a.message)}},listenHash:function(){t.listen("tabtype",function(){var e=t.get("tabtype");mdev.message.trigger("render-by-tabtype",e)})},handleTabChange:function(e){a("li[data-tabtype="+e+"]").addClass("selected").siblings(s.tab).removeClass("selected")},addEvent:function(){var e=function(e){"email"===e||"phone"===e?t.set("tabtype",e):n.location.href="/share/manage"};i.find(s.tab).click(function(){try{var t=a(this).data("tabtype");e(t)}catch(n){throw new Error(n.message)}})}};a(document).ready(function(){o._init()})});
;define("clouddisk-ui:widget/tongji/tongji.js",function(){var t="https:"==document.location.protocol?" https://":" http://";document.write(unescape("%3Cdiv style='display:none'%3E%3Cscript src='"+t+"hm.baidu.com/h.js%3F2246de2d6633217ea74fa00f3bc89b30' type='text/javascript'%3E%3C/script%3E%3C/div%3E"))});
;define("clouddisk-ui:widget/toolbar/toolbar.js",function(e){var i={mod:"div.module-toolbar",viewBtn:'a[node-type~="btn-view"]',listBtn:'a[node-type~="btn-list"]',newDirBtn:'a[node-type~="btn-new-dir"]',deviceBtn:'span[node-type~="btn-device"]',deviceMenu:'div[node-type~="device-menu"]',offlineDownloadBtn:'a[node-type~="btn-offline-download"]',btnNewDir:'a[node-type~="btn-new-dir"]',btnClose:'a[node-type~="btn-close"]',bar:'div[node-type~="bar"]',barUpload:'div[node-type~="upload-bar"]',msgText:'span[node-type~="msg-text"]',downloadLink:'a[node-type~="download-link"]',barPic:'div[node-type~="yun-pic-bar"]'},n=e("common:widget/data-center/data-center.js"),t=e("common:widget/hash/hash.js"),d=e("common:widget/libs/jquerypacket.js"),o=e("common:widget/restApi/restApi.js"),a=e("common:widget/commonService/commonService.js"),l=d(i.mod),s=null,c={},r=function(){s=new disk.common.uploadService.UploadDialog({pane:d("#uploadDialog")[0],trigger:document.getElementById("upload").parentNode,dndDropZone:d("#netdiskTips").parent().parent().get(0),dndSurroundingZone:document.documentElement,dndMarkContainer:document.body}),s.install()},p=function(){a.getWidgets("common:widget/fileUploader/upload.js",function(i){var n=e("common:widget/toast/toast.js");n.obtain.setVisible(!1),disk.common.uploadService=disk.common.uploadService||i,d("#upload").length>0&&(o.ACTIVEX_USE_UPGRADE_STRATEGY?d.ajax({url:o.ACTIVEX_UPGRADE+"&t="+(new Date).getTime(),type:"GET",timeout:3e3,success:function(e){var i=null;try{i=d.parseJSON(e),0==i.errorno&&"undefined"!=typeof i.content&&(i=i.content[0]),"undefined"!=typeof i.release&&"undefined"!=typeof i.force&&(disk.common.uploadService.NativePluginFileUploader.forceUpgrade=parseInt(i.force),disk.common.uploadService.NativePluginFileUploader.upgradeVersion=i.release,disk.common.uploadService.UploadDialog.UPGRADE_TEXT='<i class="up-dd-tip"></i><dfn class="txt1 tips-prx global-ellipsis">'+i.ext+'</dfn><a target="_blank" class="two-pix-btn" href="http://bs.baidu.com/netdisk/UploadPlugin_%s.exe">更新安装</a>')}catch(n){}finally{r()}},error:function(){r()}}):r())})},g=function(){l.delegate(i.viewBtn,"click",function(){t.set("render-type","grid-view")}),l.delegate(i.listBtn,"click",function(){t.set("render-type","list-view")}),l.delegate(i.btnClose,"click",function(){localStorage.setItem("pref_upload_ins_guide",1),l.find(i.barUpload).hide(),d(window).trigger("resize")}),l.delegate(i.newDirBtn,"click",function(){mdev.message.trigger("file-operate","new-dir")}),l.delegate(i.deviceBtn,"mouseover",function(){l.find(i.deviceMenu).show()}),l.delegate(i.deviceBtn,"mouseout",function(){l.find(i.deviceMenu).hide()}),l.delegate(i.deviceBtn,"click",function(e){switch(e.target.className){case"push":a.getWidgets("common:widget/deviceDialog/deviceDialog.js",function(e){c.deviceDialog=c.deviceDialog||new e,c.deviceDialog.show(!0)});break;case"add":a.getWidgets("common:widget/deviceAddEquipment/deviceAddEquipment.js",function(e){c.deviceAddEquipment=c.deviceAddEquipment||new e,c.deviceAddEquipment.show()})}}),l.delegate(i.offlineDownloadBtn,"click",function(){a.getWidgets("common:widget/fileOfflineDownload/fileOfflineListDialog.js",function(e){c.fileOfflineListDialog=c.fileOfflineListDialog||e.obtain(),c.fileOfflineListDialog.setVisible(!0)})})},u=function(){var e=t.get("render-type");"grid-view"===e?(l.find(i.viewBtn).addClass("view-selected"),l.find(i.listBtn).removeClass("list-selected")):(l.find(i.listBtn).addClass("list-selected"),l.find(i.viewBtn).removeClass("view-selected"))},f=function(){mdev.message.listen("upload-warn",function(e){var n=localStorage.getItem("pref_upload_ins_guide");0!=n&&n||(e&&(l.find(i.msgText).html(e),l.find(i.downloadLink).attr("href","http://bs.baidu.com/netdisk/UploadPlugin_"+disk.common.uploadService.NativePluginFileUploader.upgradeVersion+".exe")),o&&(l.find(i.barUpload).show(),d(window).trigger("resize")))});var e=function(){var e=t.get("category/type"),n=t.get("key"),d=t.get("path");e&&""!==e||n&&""!==n?l.find(i.btnNewDir).hide():l.find(i.btnNewDir).show(),d&&""!==d&&l.find(i.btnNewDir).show()};t.listen("category/type, key, path",e),e();var o=!1,a=function(){var e=t.get("category/type"),d=t.get("path"),a=n.get("is-timeline");o=!1,!a||!e||"2"!==e||d&&""!==d?(l.find(i.bar).show().css("visibility","visible"),l.find(i.barPic).hide(),o=!0):(l.find(i.bar).hide(),l.find(i.barPic).show())};t.listen("path",a),t.listen("category/type",a),a(),g(),d(document).ready(function(){p()}),t.listen("render-type",u),u()};f()});
;define("clouddisk-ui:widget/webspeed/webSpeedConfig-disk-home.js",function(require,exports,module){window.alogObjectConfig={product:"221",page:"221_100",monkey_page:"221_100",speed_page:"221_100",speed:{sample:"0.5"},monkey:{sample:"0.5"},exception:{sample:"0.5"},feature:{sample:"0.5"}},void function(e,t,n,a,r,o){function c(t){e.attachEvent?e.attachEvent("onload",t,!1):e.addEventListener&&e.addEventListener("load",t)}function i(e,n,a){a=a||15;var o=new Date;o.setTime((new Date).getTime()+1e3*a),t.cookie=e+"="+escape(n)+";path=/;expires="+o.toGMTString()}function s(e){var n=t.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return null!=n?unescape(n[2]):null}function d(){var e=s("PMS_JT");if(e){i("PMS_JT","",-1);try{e=eval(e)}catch(n){e={}}e.r&&t.referrer.replace(/#.*/,"")!=e.r||alog("speed.set","wt",e.s)}}c(function(){alog("speed.set","lt",+new Date),r=t.createElement(n),r.async=!0,r.src=a+"?v="+~(new Date/864e5),o=t.getElementsByTagName(n)[0],o.parentNode.insertBefore(r,o)}),d()}(window,document,"script","http://img.baidu.com/hunter/alog/dp.min.js")});